(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{RosF:function(a,t,e){"use strict";e.r(t),e.d(t,"DaftarTagihanNonlayananModule",function(){return N});var i=e("ofXK"),n=e("tyNb"),s=e("7zfz"),o=e("1zoS"),l=e("wd/R"),r=e("fXoL"),c=e("EJUL"),h=e("U+s4"),d=e("G0w9"),b=e("ujBT"),p=e("Nf9I"),u=e("eO1q"),m=e("3Pt+"),g=e("7kUa"),f=e("arFO"),w=e("jIHw"),k=e("xlun"),P=e("5EWq"),y=e("rEr+"),v=e("Wq6t");function T(a,t){if(1&a){const a=r.Sb();r.Qb(0,"button",23),r.Yb("click",function(){return r.yc(a),r.bc().inputTagihan()}),r.Pb()}}function S(a,t){if(1&a&&(r.Qb(0,"th",26),r.Jc(1),r.Lb(2,"p-sortIcon",27),r.Pb()),2&a){const a=t.$implicit;r.Fc("width: ",a.width,""),r.jc("pSortableColumn",a.field),r.xb(1),r.Lc(" ",a.header," "),r.xb(1),r.jc("field",a.field)}}function D(a,t){if(1&a&&(r.Qb(0,"tr"),r.Qb(1,"th",24),r.Jc(2," Aksi "),r.Pb(),r.Hc(3,S,3,6,"th",25),r.Pb()),2&a){const a=t.$implicit;r.xb(3),r.ic("ngForOf",a)}}function Q(a,t){if(1&a&&(r.Qb(0,"span"),r.Jc(1),r.Pb()),2&a){const a=r.bc().$implicit,t=r.bc().$implicit,e=r.bc();r.xb(1),r.Lc(" ",e.formatRupiah(t[a.field],"")," ")}}function C(a,t){if(1&a&&(r.Qb(0,"span"),r.Jc(1),r.Pb()),2&a){const a=r.bc().$implicit,t=r.bc().$implicit;r.xb(1),r.Lc(" ",t[a.field],"")}}function x(a,t){if(1&a&&(r.Qb(0,"td"),r.Hc(1,Q,2,1,"span",31),r.Hc(2,C,2,1,"span",31),r.Pb()),2&a){const a=t.$implicit;r.Fc("width: ",a.width,""),r.xb(1),r.ic("ngIf",null!=a.isCurrency),r.xb(1),r.ic("ngIf",null==a.isCurrency)}}const M=function(){return{display:"inline-flex"}};function Y(a,t){if(1&a){const a=r.Sb();r.Qb(0,"tr",28),r.Qb(1,"td",24),r.Qb(2,"p-splitButton",29),r.Yb("onDropdownClick",function(){r.yc(a);const e=t.$implicit;return r.bc().selectData(e)}),r.Pb(),r.Pb(),r.Hc(3,x,3,5,"td",30),r.Pb()}if(2&a){const a=t.$implicit,e=t.columns,i=t.rowIndex,n=r.bc();r.ic("pSelectableRow",a)("pSelectableRowIndex",i),r.xb(2),r.Ec(r.mc(6,M)),r.ic("model",n.listBtn),r.xb(1),r.ic("ngForOf",e)}}const J=function(){return[5,10,25,50]},H=[{path:"",component:(()=>{class a{constructor(a,t,e,i,n,s,l,r,c){this.apiService=a,this.authService=t,this.confirmationService=e,this.messageService=i,this.cacheHelper=n,this.dateHelper=s,this.alertService=l,this.route=r,this.router=c,this.pencarian="",this.item={},this.listStatus=[{id:1,status:"Lunas"},{id:2,status:"Belum Bayar"}],this.page=o.b.get().page,this.rows=o.b.get().rows}ngOnInit(){this.listBtn=[{label:"Bayar Tagihan",icon:"fa fa-money",command:()=>{this.bayarTagihan()}},{label:"Ubah Tagihan",icon:"fa fa-pencil-square-o",command:()=>{this.ubahTagihan()}},{label:"Hapus OrTagihander",icon:"fa fa-trash",command:()=>{this.hapusTagihan()}}],this.dataLogin=this.authService.dataLoginUser,this.kelUser=this.dataLogin.kelompokUser.kelompokUser,this.dateNow=new Date,this.item.tglAwal=l(this.dateNow).format("YYYY-MM-DD 00:00"),this.item.tglAkhir=l(this.dateNow).format("YYYY-MM-DD 23:59"),this.item.jmlRows=50,this.column=[{field:"no",header:"No",width:"65px"},{field:"tglstruk",header:"Tgl Transaksi",width:"140px"},{field:"namapasien",header:"Nama Pasien",width:"250px"},{field:"jenistagihan",header:"Jenis Tagihan",width:"180px"},{field:"namapasien",header:"Nama Pasien",width:"250px"},{field:"keteranganlainnya",header:"Keterangan",width:"200px"},{field:"totalharusdibayar",header:"Total Tagihan",width:"140px",isCurrency:!0},{field:"status",header:"Status",width:"140px"}],this.getDataCombo()}formatRupiah(a,t){return t+" "+parseFloat(a).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}getDataCombo(){this.apiService.get("kasir/get-combo-kasir").subscribe(a=>{this.listJenisTransaksi=a.jenistransaksinonlayanan,this.LoadCache()})}LoadCache(){var a=this.cacheHelper.get("DaftarTagihanPasienNonLayananCache");null!=a?(this.item.tglAwal=new Date(a[0]),this.item.tglAkhir=new Date(a[1]),null!=a[2]&&(this.listJenisTransaksi=[a[2]],this.item.dataTransaksi=a[2]),null!=a[4]&&(this.listStatus=[a[4]],this.item.dataStatus=a[4]),this.item.namaPasien=a[3],this.loadData()):this.loadData()}loadData(){var a=l(this.item.tglAwal).format("YYYY-MM-DD HH:mm"),t=l(this.item.tglAkhir).format("YYYY-MM-DD HH:mm"),e="",i=void 0;null!=this.item.dataTransaksi&&(e=this.item.dataTransaksi.id,i={id:this.item.dataTransaksi.id,kelompoktransaksi:this.item.dataTransaksi.kelompoktransaksi});var n="",s=void 0;null!=this.item.dataStatus&&(n=this.item.dataStatus.status,s={id:this.item.dataStatus.id,status:this.item.dataStatus.status});var o="";null!=this.item.namaPasien&&(o=this.item.namaPasien);var r="";null!=this.item.jmlRows&&(r=this.item.jmlRows),this.cacheHelper.set("DaftarTagihanPasienNonLayananCache",{0:a,1:t,2:i,3:o,4:s}),this.apiService.get("kasir/daftar-tagihan-non-layanan?namaPelanggan="+o+"&tglAwal="+a+"&tglAkhir="+t+"&jenisTagihanId="+e+"&status="+n+"&jmlRows="+r).subscribe(a=>{var t=a;for(let e=0;e<t.length;e++){const a=t[e];a.no=e+1,null==a.tglmeninggal?(a.statuspasien="Hidup",a.color="info"):(a.statuspasien="Meninggal",a.color="danger")}this.dataTable=t})}cari(){this.loadData()}selectData(a){this.selected=a}onRowSelect(a){this.selected=a.data}ubahTagihan(){null!=this.selected?"Lunas"!=this.selected.status?2!=this.selected.jenistagihanid?this.router.navigate(["input-tindakan-nonlayanan",this.selected.norec]):this.alertService.error("Info","Data Yang Dipilih Hanya Bisa Dirubah Farmasi!"):this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!"):this.alertService.warn("Info","Data Belum Dipilih!")}hapusTagihan(){if(null!=this.selected)if("Lunas"!=this.selected.status)if(2!=this.selected.jenistagihanid){var a={norec:this.selected.norec,nostruk:this.selected.nostruk};this.confirmationService.confirm({message:"Apakah Anda Akan Menghapus Transaksi Tersebut?",header:"Konfirmasi Hapus Transaksi",icon:"pi pi-info-circle",accept:()=>{this.confirmationService.close(),this.apiService.post("kasir/hapus-transaksi-non-layanan",a).subscribe(a=>{this.apiService.postLog("Hapus Pelayanan Non Layanan","Norec strukpelayan",this.selected.norec,"Hapus Pelayanan Non Layanan Dengan No Transaksi - "+this.selected.nostruk+" atas Nama Pasien - "+this.selected.namapasien).subscribe(a=>{}),this.loadData()})},reject:a=>{this.confirmationService.close(),window.history.back()}})}else this.alertService.error("Info","Data Yang Dipilih Hanya Bisa Hapus Farmasi!");else this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!");else this.alertService.warn("Info","Data Belum Dipilih!")}inputTagihan(){this.router.navigate(["input-tindakan-nonlayanan","-"])}bayarTagihan(){null!=this.selected?"Lunas"!=this.selected.status?this.router.navigate(["pembayaran-tagihan-layanan",this.selected.norec,"nonlayanan"]):this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!"):this.alertService.warn("Info","Data Belum Dipilih!")}}return a.\u0275fac=function(t){return new(t||a)(r.Jb(c.a),r.Jb(c.b),r.Jb(s.a),r.Jb(s.h),r.Jb(h.a),r.Jb(d.a),r.Jb(b.a),r.Jb(n.a),r.Jb(n.f))},a.\u0275cmp=r.Db({type:a,selectors:[["app-daftar-tagihan-nonlayanan"]],features:[r.wb([s.a])],decls:44,vars:30,consts:[["header","Confirmation","icon","fa fa-question-circle"],[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-col-12","p-md-12"],[1,"p-grid"],[1,"p-col-12","p-md-10"],[1,"p-col-12","p-md-2"],["for","input",1,"label"],["yearRange","1980:2030","dateFormat","yy-mm-dd",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","ngModelChange"],[1,"p-col-12","p-md-3"],["type","text","pInputText","","placeholder","Nama Pelanggan",3,"ngModel","ngModelChange","keyup.enter"],["placeholder","Jenis Transaksi","optionLabel","kelompoktransaksi",3,"options","ngModel","filter","showClear","ngModelChange"],["placeholder","Status Bayar","optionLabel","status",3,"options","ngModel","filter","showClear","ngModelChange"],[1,"p-col-12","p-md-6"],["type","text","pInputText","","placeholder","Jml Rows",3,"ngModel","ngModelChange","keyup.enter"],[1,"p-col-12","p-md-6",2,"margin-top","16px"],["pButton","","type","submit","icon","pi pi-search","pTooltip","Cari",3,"click"],["styleClass","p-mb-4"],["pTemplate","left"],["styleClass","p-datatable-customers","scrollable","true","sortMode","multiple","selectionMode","single",3,"columns","value","selection","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks","selectionChange","onRowSelect"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","submit","icon","pi pi-check-square","pTooltip","Input Tagihan","label","Input Tagihan",1,"p-button-success","p-mr-2",3,"click"],["width","100px"],[3,"pSortableColumn","style",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],["label","","styleClass","p-button-help p-ml-auto","icon","pi pi-ellipsis-v","appendTo","body",3,"model","onDropdownClick"],[3,"style",4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(a,t){1&a&&(r.Lb(0,"p-confirmDialog",0),r.Qb(1,"div",1),r.Qb(2,"div",2),r.Qb(3,"h4"),r.Jc(4,"Daftar Tagihan Non Layanan"),r.Pb(),r.Qb(5,"div",3),r.Qb(6,"div",4),r.Qb(7,"div",5),r.Qb(8,"div",4),r.Qb(9,"div",6),r.Qb(10,"label",7),r.Jc(11,"Periode Awal"),r.Pb(),r.Qb(12,"p-calendar",8),r.Yb("ngModelChange",function(a){return t.item.tglAwal=a}),r.Pb(),r.Pb(),r.Qb(13,"div",6),r.Qb(14,"label",7),r.Jc(15,"Periode Akhir"),r.Pb(),r.Qb(16,"p-calendar",8),r.Yb("ngModelChange",function(a){return t.item.tglAkhir=a}),r.Pb(),r.Pb(),r.Qb(17,"div",9),r.Qb(18,"label",7),r.Jc(19,"Nama Pelanggan "),r.Pb(),r.Qb(20,"input",10),r.Yb("ngModelChange",function(a){return t.item.namaPasien=a})("keyup.enter",function(){return t.cari()}),r.Pb(),r.Pb(),r.Qb(21,"div",9),r.Qb(22,"label",7),r.Jc(23,"Jenis Transaksi"),r.Pb(),r.Qb(24,"p-dropdown",11),r.Yb("ngModelChange",function(a){return t.item.dataTransaksi=a}),r.Pb(),r.Pb(),r.Qb(25,"div",6),r.Qb(26,"label",7),r.Jc(27,"Status"),r.Pb(),r.Qb(28,"p-dropdown",12),r.Yb("ngModelChange",function(a){return t.item.dataStatus=a}),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(29,"div",6),r.Qb(30,"div",4),r.Qb(31,"div",13),r.Qb(32,"label",7),r.Jc(33,"jml Rows"),r.Pb(),r.Qb(34,"input",14),r.Yb("ngModelChange",function(a){return t.item.jmlRows=a})("keyup.enter",function(){return t.cari()}),r.Pb(),r.Pb(),r.Qb(35,"div",15),r.Qb(36,"button",16),r.Yb("click",function(){return t.cari()}),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Qb(37,"div",3),r.Qb(38,"p-toolbar",17),r.Hc(39,T,1,0,"ng-template",18),r.Pb(),r.Qb(40,"p-table",19,20),r.Yb("selectionChange",function(a){return t.selected=a})("onRowSelect",function(a){return t.onRowSelect(a)}),r.Hc(42,D,4,1,"ng-template",21),r.Hc(43,Y,4,7,"ng-template",22),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&a&&(r.xb(12),r.ic("ngModel",t.item.tglAwal)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),r.xb(4),r.ic("ngModel",t.item.tglAkhir)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),r.xb(4),r.ic("ngModel",t.item.namaPasien),r.xb(4),r.ic("options",t.listJenisTransaksi)("ngModel",t.item.dataTransaksi)("filter",!0)("showClear",!0),r.xb(4),r.ic("options",t.listStatus)("ngModel",t.item.dataStatus)("filter",!0)("showClear",!0),r.xb(6),r.ic("ngModel",t.item.jmlRows),r.xb(6),r.ic("columns",t.column)("value",t.dataTable)("selection",t.selected)("rowHover",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",r.mc(29,J))("paginator",!0)("pageLinks",5))},directives:[p.a,u.a,m.g,m.h,m.a,g.a,f.a,w.b,k.a,P.a,s.k,y.h,i.k,y.g,y.f,y.e,v.a,i.l],styles:[""]}),a})()}];let I=(()=>{class a{}return a.\u0275mod=r.Hb({type:a}),a.\u0275inj=r.Gb({factory:function(t){return new(t||a)},imports:[[n.j.forChild(H)],n.j]}),a})();var L=e("PCNd");let N=(()=>{class a{}return a.\u0275mod=r.Hb({type:a}),a.\u0275inj=r.Gb({factory:function(t){return new(t||a)},imports:[[i.b,I,L.a]]}),a})()}}]);