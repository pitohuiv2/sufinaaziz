(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{UBrM:function(a,e,t){"use strict";t.r(e),t.d(e,"BayarTagihanPasienModule",function(){return R});var i=t("ofXK"),n=t("tyNb"),r=t("7zfz"),o=t("1zoS"),l=t("wd/R"),b=t("fXoL"),s=t("EJUL"),c=t("U+s4"),d=t("G0w9"),h=t("ujBT"),p=t("7CaW"),m=t("3Pt+"),g=t("7kUa"),u=t("eO1q"),y=t("arFO"),f=t("zFJ7"),P=t("jIHw"),T=t("xlun"),v=t("rEr+"),w=t("Nf9I");function Q(a,e){if(1&a&&(b.Qb(0,"th",36),b.Jc(1),b.Lb(2,"p-sortIcon",37),b.Pb()),2&a){const a=e.$implicit;b.Fc("width: ",a.width,""),b.jc("pSortableColumn",a.field),b.xb(1),b.Lc(" ",a.header," "),b.xb(1),b.jc("field",a.field)}}function B(a,e){if(1&a&&(b.Qb(0,"tr"),b.Hc(1,Q,3,6,"th",34),b.Qb(2,"th",35),b.Jc(3," # "),b.Pb(),b.Pb()),2&a){const a=e.$implicit;b.xb(1),b.ic("ngForOf",a)}}function x(a,e){if(1&a&&(b.Qb(0,"span"),b.Jc(1),b.Pb()),2&a){const a=b.bc().$implicit,e=b.bc().$implicit,t=b.bc();b.xb(1),b.Lc(" ",t.formatRupiah(e[a.field],"")," ")}}function C(a,e){if(1&a&&(b.Qb(0,"span"),b.Jc(1),b.Pb()),2&a){const a=b.bc().$implicit,e=b.bc().$implicit;b.xb(1),b.Lc(" ",e[a.field],"")}}function M(a,e){if(1&a&&(b.Qb(0,"td"),b.Hc(1,x,2,1,"span",41),b.Hc(2,C,2,1,"span",41),b.Pb()),2&a){const a=e.$implicit;b.Fc("width: ",a.width,""),b.xb(1),b.ic("ngIf",null!=a.isCurrency),b.xb(1),b.ic("ngIf",null==a.isCurrency)}}function S(a,e){if(1&a){const a=b.Sb();b.Qb(0,"tr",38),b.Hc(1,M,3,5,"td",39),b.Qb(2,"td",35),b.Qb(3,"button",40),b.Yb("click",function(){b.yc(a);const t=e.$implicit;return b.bc().hapusItem(t)}),b.Pb(),b.Pb(),b.Pb()}if(2&a){const a=e.columns,t=e.rowIndex;b.ic("pSelectableRow",e.$implicit)("pSelectableRowIndex",t),b.xb(1),b.ic("ngForOf",a)}}const k=function(){return[5,10,25,50]},D=function(){return{width:"50vw"}},J=[{path:"",component:(()=>{class a{constructor(a,e,t,i,n,r,l,b,s){this.apiService=a,this.authService=e,this.confirmationService=t,this.messageService=i,this.cacheHelper=n,this.dateHelper=r,this.alertService=l,this.route=b,this.router=s,this.params={},this.dataTable=[],this.item={pasien:{}},this.dataPrevPage={},this.maxDateValue=new Date,this.page=o.b.get().page,this.rows=o.b.get().rows}ngOnInit(){this.dateNow=new Date,this.item.tglBayar=this.dateNow,this.column=[{field:"no",header:"No",width:"65px"},{field:"caraBayar",header:"Cara Bayar",width:"140px"},{field:"nominal",header:"Nominal",width:"100px",isCurrency:!0}],this.route.params.subscribe(a=>{this.currentNorecSP=a.norec_sp,this.currentJenisPembayaran=a.jenispembayaran,this.JenisPembayaran=a.jenispembayaran,this.norec_sp=this.currentNorecSP,this.nominalBayar=parseFloat(a.nominalbayar),this.dataPrevPage={noRecStrukPelayanan:this.norec_sp,tipePembayaran:this.JenisPembayaran},this.LoadCombo()})}LoadCombo(){this.apiService.get("kasir/get-combo-kasir").subscribe(a=>{var e=a;this.listCaraBayar=e.carabayar,this.item.caraBayar=e.carabayar[0],this.dataPegawai=e.dataLogin,this.dataPegawai&&(this.idKasir=this.dataPegawai.objectpegawaifk,this.namaKasir=this.dataPegawai.namalengkap),this.LoadData()})}formatRupiah(a,e){return e+" "+parseFloat(a).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}LoadData(){this.apiService.get("kasir/get-data-pembayaran?noRecStrukPelayanan="+this.norec_sp+"&tipePembayaran="+this.JenisPembayaran+"&jumlahBayar="+this.nominalBayar).subscribe(a=>{var e=a;this.item.Diterima=e.pasien,this.Tagihan=parseFloat(e.jumlahBayar),this.item.Nominal=parseFloat(e.jumlahBayar),this.changeNominal(e.jumlahBayar),this.item.totalTagihan=this.formatRupiah(this.Tagihan,"Rp."),this.item.TotalDibayar=this.formatRupiah(this.Tagihan,"Rp.")})}Batal(){this.item.Nominal=void 0,this.item.Terbilang=void 0}changeNominal(a){null!=a&&""!=a&&this.apiService.get("sysadmin/general/get-terbilang/"+parseFloat(a)).subscribe(a=>{this.item.Terbilang=a.terbilang})}tambahBayar(){if(null!=this.item.caraBayar)if(null!=this.item.Nominal&&""!=this.item.Nominal){this.dataTable.push({no:0==this.dataTable.length?1:this.dataTable.length+1,caraBayar:this.item.caraBayar.carabayar,idcaraBayar:this.item.caraBayar.id,nominal:parseFloat(this.item.Nominal)});var a=0;for(let e=0;e<this.dataTable.length;e++)a=this.dataTable[e].nominal+a;this.item.Total=a,this.item.Terbilang=void 0,this.item.Nominal=void 0}else this.alertService.warn("Info","Nominal Tidak Boleh Kosong!");else this.alertService.warn("Info","Cara Bayar Belum Dipilih!")}hapusItem(a){for(var e=this.dataTable.length-1;e>=0;e--)this.dataTable[e].no==a.no&&this.dataTable.splice(e,1);var t=0;for(let i=0;i<this.dataTable.length;i++)t=this.dataTable[i].nominal+t;this.item.Total=t}bayarTagihan(){if(null!=this.item.Total&&0!=this.item.Total)if(this.item.Total==this.Tagihan){var a={parameterTambahan:this.dataPrevPage,jumlahBayar:this.item.Tota,biayaAdministrasi:0,diskon:0,tglsbm:l(this.item.TglBayar).format("YYYY-MM-DD HH:mm"),pembayaran:[]};for(let e=0;e<this.dataTable.length;e++){const t=this.dataTable[e];a.pembayaran.push({nominal:t.nominal,caraBayar:{id:t.idcaraBayar,caraBayar:t.caraBayar}})}this.isSimpan=!0,this.apiService.post("kasir/simpan-data-pembayaran",a).subscribe(a=>{var e;this.apiService.postLog("Pembayaran Tagihan "+this.JenisPembayaran,"nomor sbm",a.noSBM[0],"Pembayaran Tagihan No SBM - "+a.noSBM[0]+" pada No Registrasi "+a.noReg).subscribe(a=>{}),e=confirm("View Kwitansi? ")?"true":"false",this.apiService.getUrlCetak("http://127.0.0.1:3885/desk/routes?cetak-kwitansi=1&nosbm="+a.norec+"&idpegawai="+this.authService.getDataLoginUser().pegawai.namaLengkap+"&view="+e,function(a){}),window.history.back(),this.isSimpan=!1},a=>{this.isSimpan=!1})}else this.alertService.warn("Info","Total Bayar Tidak Sama Dengan Tagihan!");else this.alertService.warn("Info","Total Bayar Tidak Boleh Kosong!")}Kembali(){window.history.back()}onRowSelect(a){}changeKlaim(a){}}return a.\u0275fac=function(e){return new(e||a)(b.Jb(s.a),b.Jb(s.b),b.Jb(r.a),b.Jb(r.h),b.Jb(c.a),b.Jb(d.a),b.Jb(h.a),b.Jb(n.a),b.Jb(n.f))},a.\u0275cmp=b.Db({type:a,selectors:[["app-bayar-tagihan-pasien"]],features:[b.wb([r.a])],decls:71,vars:35,consts:[[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-grid"],[1,"p-col-12","p-md-3"],["header","Data Tagihan",3,"toggleable"],[1,"p-col-12","p-md-12"],["for","input"],["type","text","pInputText","","placeholder","Total Tagihan","disabled","",3,"ngModel","ngModelChange"],["for","input",1,"label-required"],["yearRange","1980:2030","dateFormat","yy-mm-dd","placeholder","Tgl Bayar","hourFormat","24",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","maxDate","ngModelChange"],["type","text","pInputText","","placeholder","Total Harus Dibayar","disabled","",3,"ngModel","ngModelChange"],["placeholder","Cara Bayar","optionLabel","carabayar",3,"options","ngModel","filter","showClear","ngModelChange"],["pInputTextarea","","placeholder","Terbilang","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Nominal Bayar",3,"ngModel","ngModelChange"],[1,"p-col-12","p-md-5","p-md-offset-2"],["pButton","","type","submit","icon","fa fa-plus","pTooltip","Tambah Bayar","label","Tambah",3,"click"],[1,"p-col-12","p-md-5"],["pButton","","type","submit","icon","fa fa-ban","pTooltip","Batal","label","Batal",1,"p-button-danger",3,"click"],[1,"p-col-12","p-md-9"],["header","Daftar Bayar",3,"toggleable"],["styleClass","p-datatable-customers","scrollable","true","sortMode","multiple","selectionMode","single",3,"columns","value","selection","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks","selectionChange","onRowSelect"],["dt",""],["pTemplate","header"],["pTemplate","body"],[1,"p-col-12","p-md-6"],["header","Detail",3,"toggleable"],["pInputTextarea","","placeholder","Diterima Dari","disabled","",3,"ngModel","ngModelChange"],["header","Total Bayar",3,"toggleable"],["pInputTextarea","","placeholder","Total Dibayarkan","disabled","",3,"ngModel","ngModelChange"],[1,"p-col-12","p-md-8"],[1,"p-col-12","p-md-2",2,"margin-top","15px"],["rejectButtonStyleClass","p-button-text",3,"baseZIndex"],["pButton","","type","submit","icon","fa fa-money","pTooltip","Bayar","label","Bayar",1,"p-button-success",3,"disabled","click"],["pButton","","type","submit","icon","fa fa-undo","pTooltip","Kembali","label","Kembali",1,"p-button-danger",3,"click"],[3,"pSortableColumn","style",4,"ngFor","ngForOf"],[2,"width","80px"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"style",4,"ngFor","ngForOf"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Hapus Data","label","",1,"p-button-rounded","p-button-danger","p-mr-2",3,"click"],[4,"ngIf"]],template:function(a,e){1&a&&(b.Qb(0,"div",0),b.Qb(1,"div",1),b.Qb(2,"h4"),b.Jc(3,"Penerimaan Pembayaran"),b.Pb(),b.Qb(4,"div",2),b.Qb(5,"div",3),b.Qb(6,"p-panel",4),b.Qb(7,"div",2),b.Qb(8,"div",5),b.Qb(9,"label",6),b.Jc(10,"Total Tagihan"),b.Pb(),b.Qb(11,"input",7),b.Yb("ngModelChange",function(a){return e.item.totalTagihan=a}),b.Pb(),b.Pb(),b.Qb(12,"div",5),b.Qb(13,"label",8),b.Jc(14," Tgl Bayar "),b.Pb(),b.Qb(15,"p-calendar",9),b.Yb("ngModelChange",function(a){return e.item.tglBayar=a}),b.Pb(),b.Pb(),b.Qb(16,"div",5),b.Qb(17,"label",6),b.Jc(18,"Total Harus Dibayar"),b.Pb(),b.Qb(19,"input",10),b.Yb("ngModelChange",function(a){return e.item.TotalDibayar=a}),b.Pb(),b.Pb(),b.Qb(20,"div",5),b.Qb(21,"label",8),b.Jc(22,"Cara Bayar"),b.Pb(),b.Qb(23,"p-dropdown",11),b.Yb("ngModelChange",function(a){return e.item.caraBayar=a}),b.Pb(),b.Pb(),b.Qb(24,"div",5),b.Qb(25,"label",6),b.Jc(26,"Terbilang"),b.Pb(),b.Qb(27,"textarea",12),b.Yb("ngModelChange",function(a){return e.item.Terbilang=a}),b.Pb(),b.Pb(),b.Qb(28,"div",5),b.Qb(29,"label",8),b.Jc(30,"Nominal"),b.Pb(),b.Qb(31,"input",13),b.Yb("ngModelChange",function(a){return e.item.Nominal=a})("ngModelChange",function(){return e.changeNominal(e.item.Nominal)}),b.Pb(),b.Pb(),b.Qb(32,"div",5),b.Qb(33,"div",2),b.Qb(34,"div",14),b.Qb(35,"button",15),b.Yb("click",function(){return e.tambahBayar()}),b.Pb(),b.Pb(),b.Qb(36,"div",16),b.Qb(37,"button",17),b.Yb("click",function(){return e.Batal()}),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(38,"div",18),b.Qb(39,"div",2),b.Qb(40,"div",5),b.Qb(41,"p-panel",19),b.Qb(42,"div",5),b.Qb(43,"p-table",20,21),b.Yb("selectionChange",function(a){return e.selected=a})("onRowSelect",function(a){return e.onRowSelect(a)}),b.Hc(45,B,4,1,"ng-template",22),b.Hc(46,S,4,3,"ng-template",23),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(47,"div",5),b.Qb(48,"div",2),b.Qb(49,"div",24),b.Qb(50,"p-panel",25),b.Qb(51,"div",2),b.Qb(52,"div",5),b.Qb(53,"label",6),b.Jc(54,"Diterima Dari"),b.Pb(),b.Qb(55,"textarea",26),b.Yb("ngModelChange",function(a){return e.item.Diterima=a}),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(56,"div",24),b.Qb(57,"p-panel",27),b.Qb(58,"div",2),b.Qb(59,"div",5),b.Qb(60,"label",6),b.Jc(61,"Total"),b.Pb(),b.Qb(62,"textarea",28),b.Yb("ngModelChange",function(a){return e.item.Total=a}),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Qb(63,"div",5),b.Qb(64,"div",2),b.Lb(65,"div",29),b.Qb(66,"div",30),b.Lb(67,"p-confirmDialog",31),b.Qb(68,"button",32),b.Yb("click",function(){return e.bayarTagihan()}),b.Pb(),b.Pb(),b.Qb(69,"div",30),b.Qb(70,"button",33),b.Yb("click",function(){return e.Kembali()}),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb(),b.Pb()),2&a&&(b.xb(6),b.ic("toggleable",!1),b.xb(5),b.ic("ngModel",e.item.totalTagihan),b.xb(4),b.ic("ngModel",e.item.tglBayar)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0)("maxDate",e.maxDateValue),b.xb(4),b.ic("ngModel",e.item.TotalDibayar),b.xb(4),b.ic("options",e.listCaraBayar)("ngModel",e.item.caraBayar)("filter",!0)("showClear",!0),b.xb(4),b.ic("ngModel",e.item.Terbilang),b.xb(4),b.ic("ngModel",e.item.Nominal),b.xb(10),b.ic("toggleable",!1),b.xb(2),b.ic("columns",e.column)("value",e.dataTable)("selection",e.selected)("rowHover",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",b.mc(33,k))("paginator",!0)("pageLinks",5),b.xb(7),b.ic("toggleable",!1),b.xb(5),b.ic("ngModel",e.item.Diterima),b.xb(2),b.ic("toggleable",!1),b.xb(5),b.ic("ngModel",e.item.Total),b.xb(5),b.Ec(b.mc(34,D)),b.ic("baseZIndex",1e4),b.xb(1),b.ic("disabled",e.isSimpan))},directives:[p.a,m.a,g.a,m.g,m.h,u.a,y.a,f.a,P.b,T.a,v.h,r.k,w.a,i.k,v.g,v.f,v.e,i.l],styles:[""]}),a})()}];let N=(()=>{class a{}return a.\u0275mod=b.Hb({type:a}),a.\u0275inj=b.Gb({factory:function(e){return new(e||a)},imports:[[n.j.forChild(J)],n.j]}),a})();var I=t("PCNd");let R=(()=>{class a{}return a.\u0275mod=b.Hb({type:a}),a.\u0275inj=b.Gb({factory:function(e){return new(e||a)},imports:[[i.b,N,I.a]]}),a})()}}]);