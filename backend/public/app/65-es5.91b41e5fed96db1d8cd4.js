!function(){function a(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function e(a,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{RosF:function(t,i,n){"use strict";n.r(i),n.d(i,"DaftarTagihanNonlayananModule",function(){return F});var s=n("ofXK"),o=n("tyNb"),r=n("7zfz"),l=n("1zoS"),c=n("wd/R"),u=n("fXoL"),h=n("EJUL"),d=n("U+s4"),b=n("G0w9"),p=n("ujBT"),m=n("Nf9I"),g=n("eO1q"),f=n("3Pt+"),v=n("7kUa"),w=n("arFO"),k=n("jIHw"),y=n("xlun"),P=n("5EWq"),T=n("rEr+"),S=n("Wq6t");function D(a,e){if(1&a){var t=u.Sb();u.Qb(0,"button",23),u.Yb("click",function(){return u.yc(t),u.bc().inputTagihan()}),u.Pb()}}function Q(a,e){if(1&a&&(u.Qb(0,"th",26),u.Jc(1),u.Lb(2,"p-sortIcon",27),u.Pb()),2&a){var t=e.$implicit;u.Fc("width: ",t.width,""),u.jc("pSortableColumn",t.field),u.xb(1),u.Lc(" ",t.header," "),u.xb(1),u.jc("field",t.field)}}function C(a,e){if(1&a&&(u.Qb(0,"tr"),u.Qb(1,"th",24),u.Jc(2," Aksi "),u.Pb(),u.Hc(3,Q,3,6,"th",25),u.Pb()),2&a){var t=e.$implicit;u.xb(3),u.ic("ngForOf",t)}}function x(a,e){if(1&a&&(u.Qb(0,"span"),u.Jc(1),u.Pb()),2&a){var t=u.bc().$implicit,i=u.bc().$implicit,n=u.bc();u.xb(1),u.Lc(" ",n.formatRupiah(i[t.field],"")," ")}}function M(a,e){if(1&a&&(u.Qb(0,"span"),u.Jc(1),u.Pb()),2&a){var t=u.bc().$implicit,i=u.bc().$implicit;u.xb(1),u.Lc(" ",i[t.field],"")}}function Y(a,e){if(1&a&&(u.Qb(0,"td"),u.Hc(1,x,2,1,"span",31),u.Hc(2,M,2,1,"span",31),u.Pb()),2&a){var t=e.$implicit;u.Fc("width: ",t.width,""),u.xb(1),u.ic("ngIf",null!=t.isCurrency),u.xb(1),u.ic("ngIf",null==t.isCurrency)}}var J=function(){return{display:"inline-flex"}};function H(a,e){if(1&a){var t=u.Sb();u.Qb(0,"tr",28),u.Qb(1,"td",24),u.Qb(2,"p-splitButton",29),u.Yb("onDropdownClick",function(){u.yc(t);var a=e.$implicit;return u.bc().selectData(a)}),u.Pb(),u.Pb(),u.Hc(3,Y,3,5,"td",30),u.Pb()}if(2&a){var i=e.$implicit,n=e.columns,s=e.rowIndex,o=u.bc();u.ic("pSelectableRow",i)("pSelectableRowIndex",s),u.xb(2),u.Ec(u.mc(6,J)),u.ic("model",o.listBtn),u.xb(1),u.ic("ngForOf",n)}}var I,L,N,R=function(){return[5,10,25,50]},j=[{path:"",component:(I=function(){function t(e,i,n,s,o,r,c,u,h){a(this,t),this.apiService=e,this.authService=i,this.confirmationService=n,this.messageService=s,this.cacheHelper=o,this.dateHelper=r,this.alertService=c,this.route=u,this.router=h,this.pencarian="",this.item={},this.listStatus=[{id:1,status:"Lunas"},{id:2,status:"Belum Bayar"}],this.page=l.b.get().page,this.rows=l.b.get().rows}var i,n,s;return i=t,(n=[{key:"ngOnInit",value:function(){var a=this;this.listBtn=[{label:"Bayar Tagihan",icon:"fa fa-money",command:function(){a.bayarTagihan()}},{label:"Ubah Tagihan",icon:"fa fa-pencil-square-o",command:function(){a.ubahTagihan()}},{label:"Hapus OrTagihander",icon:"fa fa-trash",command:function(){a.hapusTagihan()}}],this.dataLogin=this.authService.dataLoginUser,this.kelUser=this.dataLogin.kelompokUser.kelompokUser,this.dateNow=new Date,this.item.tglAwal=c(this.dateNow).format("YYYY-MM-DD 00:00"),this.item.tglAkhir=c(this.dateNow).format("YYYY-MM-DD 23:59"),this.item.jmlRows=50,this.column=[{field:"no",header:"No",width:"65px"},{field:"tglstruk",header:"Tgl Transaksi",width:"140px"},{field:"namapasien",header:"Nama Pasien",width:"250px"},{field:"jenistagihan",header:"Jenis Tagihan",width:"180px"},{field:"namapasien",header:"Nama Pasien",width:"250px"},{field:"keteranganlainnya",header:"Keterangan",width:"200px"},{field:"totalharusdibayar",header:"Total Tagihan",width:"140px",isCurrency:!0},{field:"status",header:"Status",width:"140px"}],this.getDataCombo()}},{key:"formatRupiah",value:function(a,e){return e+" "+parseFloat(a).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}},{key:"getDataCombo",value:function(){var a=this;this.apiService.get("kasir/get-combo-kasir").subscribe(function(e){a.listJenisTransaksi=e.jenistransaksinonlayanan,a.LoadCache()})}},{key:"LoadCache",value:function(){var a=this.cacheHelper.get("DaftarTagihanPasienNonLayananCache");null!=a?(this.item.tglAwal=new Date(a[0]),this.item.tglAkhir=new Date(a[1]),null!=a[2]&&(this.listJenisTransaksi=[a[2]],this.item.dataTransaksi=a[2]),null!=a[4]&&(this.listStatus=[a[4]],this.item.dataStatus=a[4]),this.item.namaPasien=a[3],this.loadData()):this.loadData()}},{key:"loadData",value:function(){var a=this,e=c(this.item.tglAwal).format("YYYY-MM-DD HH:mm"),t=c(this.item.tglAkhir).format("YYYY-MM-DD HH:mm"),i="",n=void 0;null!=this.item.dataTransaksi&&(i=this.item.dataTransaksi.id,n={id:this.item.dataTransaksi.id,kelompoktransaksi:this.item.dataTransaksi.kelompoktransaksi});var s="",o=void 0;null!=this.item.dataStatus&&(s=this.item.dataStatus.status,o={id:this.item.dataStatus.id,status:this.item.dataStatus.status});var r="";null!=this.item.namaPasien&&(r=this.item.namaPasien);var l="";null!=this.item.jmlRows&&(l=this.item.jmlRows),this.cacheHelper.set("DaftarTagihanPasienNonLayananCache",{0:e,1:t,2:n,3:r,4:o}),this.apiService.get("kasir/daftar-tagihan-non-layanan?namaPelanggan="+r+"&tglAwal="+e+"&tglAkhir="+t+"&jenisTagihanId="+i+"&status="+s+"&jmlRows="+l).subscribe(function(e){for(var t=e,i=0;i<t.length;i++){var n=t[i];n.no=i+1,null==n.tglmeninggal?(n.statuspasien="Hidup",n.color="info"):(n.statuspasien="Meninggal",n.color="danger")}a.dataTable=t})}},{key:"cari",value:function(){this.loadData()}},{key:"selectData",value:function(a){this.selected=a}},{key:"onRowSelect",value:function(a){this.selected=a.data}},{key:"ubahTagihan",value:function(){null!=this.selected?"Lunas"!=this.selected.status?2!=this.selected.jenistagihanid?this.router.navigate(["input-tindakan-nonlayanan",this.selected.norec]):this.alertService.error("Info","Data Yang Dipilih Hanya Bisa Dirubah Farmasi!"):this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!"):this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"hapusTagihan",value:function(){var a=this;if(null!=this.selected)if("Lunas"!=this.selected.status)if(2!=this.selected.jenistagihanid){var e={norec:this.selected.norec,nostruk:this.selected.nostruk};this.confirmationService.confirm({message:"Apakah Anda Akan Menghapus Transaksi Tersebut?",header:"Konfirmasi Hapus Transaksi",icon:"pi pi-info-circle",accept:function(){a.confirmationService.close(),a.apiService.post("kasir/hapus-transaksi-non-layanan",e).subscribe(function(e){a.apiService.postLog("Hapus Pelayanan Non Layanan","Norec strukpelayan",a.selected.norec,"Hapus Pelayanan Non Layanan Dengan No Transaksi - "+a.selected.nostruk+" atas Nama Pasien - "+a.selected.namapasien).subscribe(function(a){}),a.loadData()})},reject:function(e){a.confirmationService.close(),window.history.back()}})}else this.alertService.error("Info","Data Yang Dipilih Hanya Bisa Hapus Farmasi!");else this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!");else this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"inputTagihan",value:function(){this.router.navigate(["input-tindakan-nonlayanan","-"])}},{key:"bayarTagihan",value:function(){null!=this.selected?"Lunas"!=this.selected.status?this.router.navigate(["pembayaran-tagihan-layanan",this.selected.norec,"nonlayanan"]):this.alertService.warn("Info","Data Yang Dipilih Sudah Dibayar!"):this.alertService.warn("Info","Data Belum Dipilih!")}}])&&e(i.prototype,n),s&&e(i,s),t}(),I.\u0275fac=function(a){return new(a||I)(u.Jb(h.a),u.Jb(h.b),u.Jb(r.a),u.Jb(r.h),u.Jb(d.a),u.Jb(b.a),u.Jb(p.a),u.Jb(o.a),u.Jb(o.f))},I.\u0275cmp=u.Db({type:I,selectors:[["app-daftar-tagihan-nonlayanan"]],features:[u.wb([r.a])],decls:44,vars:30,consts:[["header","Confirmation","icon","fa fa-question-circle"],[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-col-12","p-md-12"],[1,"p-grid"],[1,"p-col-12","p-md-10"],[1,"p-col-12","p-md-2"],["for","input",1,"label"],["yearRange","1980:2030","dateFormat","yy-mm-dd",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","ngModelChange"],[1,"p-col-12","p-md-3"],["type","text","pInputText","","placeholder","Nama Pelanggan",3,"ngModel","ngModelChange","keyup.enter"],["placeholder","Jenis Transaksi","optionLabel","kelompoktransaksi",3,"options","ngModel","filter","showClear","ngModelChange"],["placeholder","Status Bayar","optionLabel","status",3,"options","ngModel","filter","showClear","ngModelChange"],[1,"p-col-12","p-md-6"],["type","text","pInputText","","placeholder","Jml Rows",3,"ngModel","ngModelChange","keyup.enter"],[1,"p-col-12","p-md-6",2,"margin-top","16px"],["pButton","","type","submit","icon","pi pi-search","pTooltip","Cari",3,"click"],["styleClass","p-mb-4"],["pTemplate","left"],["styleClass","p-datatable-customers","scrollable","true","sortMode","multiple","selectionMode","single",3,"columns","value","selection","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks","selectionChange","onRowSelect"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","submit","icon","pi pi-check-square","pTooltip","Input Tagihan","label","Input Tagihan",1,"p-button-success","p-mr-2",3,"click"],["width","100px"],[3,"pSortableColumn","style",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],["label","","styleClass","p-button-help p-ml-auto","icon","pi pi-ellipsis-v","appendTo","body",3,"model","onDropdownClick"],[3,"style",4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(a,e){1&a&&(u.Lb(0,"p-confirmDialog",0),u.Qb(1,"div",1),u.Qb(2,"div",2),u.Qb(3,"h4"),u.Jc(4,"Daftar Tagihan Non Layanan"),u.Pb(),u.Qb(5,"div",3),u.Qb(6,"div",4),u.Qb(7,"div",5),u.Qb(8,"div",4),u.Qb(9,"div",6),u.Qb(10,"label",7),u.Jc(11,"Periode Awal"),u.Pb(),u.Qb(12,"p-calendar",8),u.Yb("ngModelChange",function(a){return e.item.tglAwal=a}),u.Pb(),u.Pb(),u.Qb(13,"div",6),u.Qb(14,"label",7),u.Jc(15,"Periode Akhir"),u.Pb(),u.Qb(16,"p-calendar",8),u.Yb("ngModelChange",function(a){return e.item.tglAkhir=a}),u.Pb(),u.Pb(),u.Qb(17,"div",9),u.Qb(18,"label",7),u.Jc(19,"Nama Pelanggan "),u.Pb(),u.Qb(20,"input",10),u.Yb("ngModelChange",function(a){return e.item.namaPasien=a})("keyup.enter",function(){return e.cari()}),u.Pb(),u.Pb(),u.Qb(21,"div",9),u.Qb(22,"label",7),u.Jc(23,"Jenis Transaksi"),u.Pb(),u.Qb(24,"p-dropdown",11),u.Yb("ngModelChange",function(a){return e.item.dataTransaksi=a}),u.Pb(),u.Pb(),u.Qb(25,"div",6),u.Qb(26,"label",7),u.Jc(27,"Status"),u.Pb(),u.Qb(28,"p-dropdown",12),u.Yb("ngModelChange",function(a){return e.item.dataStatus=a}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(29,"div",6),u.Qb(30,"div",4),u.Qb(31,"div",13),u.Qb(32,"label",7),u.Jc(33,"jml Rows"),u.Pb(),u.Qb(34,"input",14),u.Yb("ngModelChange",function(a){return e.item.jmlRows=a})("keyup.enter",function(){return e.cari()}),u.Pb(),u.Pb(),u.Qb(35,"div",15),u.Qb(36,"button",16),u.Yb("click",function(){return e.cari()}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(37,"div",3),u.Qb(38,"p-toolbar",17),u.Hc(39,D,1,0,"ng-template",18),u.Pb(),u.Qb(40,"p-table",19,20),u.Yb("selectionChange",function(a){return e.selected=a})("onRowSelect",function(a){return e.onRowSelect(a)}),u.Hc(42,C,4,1,"ng-template",21),u.Hc(43,H,4,7,"ng-template",22),u.Pb(),u.Pb(),u.Pb(),u.Pb()),2&a&&(u.xb(12),u.ic("ngModel",e.item.tglAwal)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),u.xb(4),u.ic("ngModel",e.item.tglAkhir)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),u.xb(4),u.ic("ngModel",e.item.namaPasien),u.xb(4),u.ic("options",e.listJenisTransaksi)("ngModel",e.item.dataTransaksi)("filter",!0)("showClear",!0),u.xb(4),u.ic("options",e.listStatus)("ngModel",e.item.dataStatus)("filter",!0)("showClear",!0),u.xb(6),u.ic("ngModel",e.item.jmlRows),u.xb(6),u.ic("columns",e.column)("value",e.dataTable)("selection",e.selected)("rowHover",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",u.mc(29,R))("paginator",!0)("pageLinks",5))},directives:[m.a,g.a,f.g,f.h,f.a,v.a,w.a,k.b,y.a,P.a,r.k,T.h,s.k,T.g,T.f,T.e,S.a,s.l],styles:[""]}),I)}],A=((L=function e(){a(this,e)}).\u0275mod=u.Hb({type:L}),L.\u0275inj=u.Gb({factory:function(a){return new(a||L)},imports:[[o.j.forChild(j)],o.j]}),L),B=n("PCNd"),F=((N=function e(){a(this,e)}).\u0275mod=u.Hb({type:N}),N.\u0275inj=u.Gb({factory:function(a){return new(a||N)},imports:[[s.b,A,B.a]]}),N)}}])}();