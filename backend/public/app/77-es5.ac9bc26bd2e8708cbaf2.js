!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{bSkc:function(a,i,n){"use strict";n.r(i),n.d(i,"DaftarStokRuanganModule",function(){return U});var o=n("ofXK"),l=n("tyNb"),r=n("7zfz"),d=n("1zoS"),s=n("wd/R"),u=n("fXoL"),c=n("EJUL"),b=n("U+s4"),p=n("G0w9"),m=n("ujBT"),g=n("Nf9I"),h=n("arFO"),k=n("3Pt+"),f=n("7kUa"),P=n("jIHw"),v=n("xlun"),y=n("rEr+"),w=n("/RsI"),Q=n("eO1q"),S=n("Ks7X");function j(e,t){if(1&e&&(u.Qb(0,"th",38),u.Jc(1),u.Lb(2,"p-sortIcon",39),u.Pb()),2&e){var a=t.$implicit;u.Fc("width: ",a.width,""),u.jc("pSortableColumn",a.field),u.xb(1),u.Lc(" ",a.header," "),u.xb(1),u.jc("field",a.field)}}function x(e,t){if(1&e&&(u.Qb(0,"tr"),u.Hc(1,j,3,6,"th",37),u.Pb()),2&e){var a=t.$implicit;u.xb(1),u.ic("ngForOf",a)}}function M(e,t){if(1&e&&(u.Qb(0,"span"),u.Jc(1),u.Pb()),2&e){var a=u.bc().$implicit,i=u.bc().$implicit,n=u.bc();u.xb(1),u.Lc(" ",n.formatRupiah(i[a.field],"")," ")}}function C(e,t){if(1&e&&(u.Qb(0,"span"),u.Jc(1),u.Pb()),2&e){var a=u.bc().$implicit,i=u.bc().$implicit;u.xb(1),u.Lc(" ",i[a.field],"")}}function T(e,t){if(1&e&&(u.Qb(0,"td"),u.Hc(1,M,2,1,"span",45),u.Hc(2,C,2,1,"span",45),u.Pb()),2&e){var a=t.$implicit;u.Fc("width: ",a.width,""),u.xb(1),u.ic("ngIf",null!=a.isCurrency),u.xb(1),u.ic("ngIf",null==a.isCurrency)}}function R(e,t){if(1&e){var a=u.Sb();u.Qb(0,"tr",40),u.Qb(1,"td",41),u.Qb(2,"button",42),u.Yb("click",function(){u.yc(a);var e=t.$implicit;return u.bc().popUpTglKadaluarsa2(e)}),u.Pb(),u.Qb(3,"button",43),u.Yb("click",function(){u.yc(a);var e=t.$implicit;return u.bc().popUpAdjusmentStok2(e)}),u.Pb(),u.Pb(),u.Hc(4,T,3,5,"td",44),u.Pb()}if(2&e){var i=t.columns,n=t.rowIndex;u.ic("pSelectableRow",t.$implicit)("pSelectableRowIndex",n),u.xb(4),u.ic("ngForOf",i)}}var J,Y,D,K=function(){return[5,10,25,50]},A=function(){return{width:"650px",minWidth:"650px"}},B=function(){return{width:"800px",minWidth:"800px"}},q=[{path:"",component:(J=function(){function a(t,i,n,o,l,r,s,u){e(this,a),this.apiService=t,this.authService=i,this.confirmationService=n,this.messageService=o,this.cacheHelper=l,this.dateHelper=r,this.alertService=s,this.route=u,this.item={},this.page=d.b.get().page,this.rows=d.b.get().rows}var i,n,o;return i=a,(n=[{key:"ngOnInit",value:function(){this.dataLogin=this.authService.getDataLoginUser(),this.kelUser=this.dataLogin.kelompokUser.kelompokUser,this.dateNow=new Date,this.item.jmlRows=10,this.column=[{field:"no",header:"No",width:"65px"},{field:"noTerima",header:"No Terima",width:"140px"},{field:"kodeProduk",header:"Kode Produk",width:"140px"},{field:"namaProduk",header:"Nama Produk",width:"300px"},{field:"asalProduk",header:"Asal Produk",width:"180px"},{field:"qtyProduk",header:"Stok",width:"120px"},{field:"satuanStandar",header:"Satuan",width:"120px"},{field:"tglKadaluarsa",header:"Tgl Exp",width:"140px"},{field:"harga",header:"Harga",width:"140px",isCurrency:!0},{field:"noBatch",header:"No Batch",width:"140px"}],this.loadDataCombo()}},{key:"loadDataCombo",value:function(){var e=this;this.apiService.get("logistik/get-combo-logistik").subscribe(function(t){e.listRuangan=null!=e.dataLogin.mapLoginUserToRuangan?e.dataLogin.mapLoginUserToRuangan:t.ruangfarmasi,e.item.dataRuangan=e.listRuangan[0]}),this.apiService.get("logistik/get-combo-detailjenisproduk").subscribe(function(t){e.listDetailJenisProduk=t.detailjenisproduk})}},{key:"isiJenisProduk",value:function(){null!=this.item.dataDjenisProduk&&(this.listJenisBarang=this.item.dataDjenisProduk.jenisproduk)}},{key:"isiKelompokProduk",value:function(){null!=this.item.dataJenisBarang&&(this.listKelompokBarang=this.item.dataJenisBarang.kelompokproduk)}},{key:"formatRupiah",value:function(e,t){return t+" "+parseFloat(e).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}},{key:"loadData",value:function(){var e,t,a,i,n,o=this;i="",null!=this.item.dataRuangan&&(i=this.item.dataRuangan.id),e="",null!=this.item.dataDjenisProduk&&(e=this.item.dataDjenisProduk.id),t="",null!=this.item.dataKelompokBarang&&(t=this.item.dataKelompokBarang.id),a="",null!=this.item.dataJenisBarang&&(a=this.item.dataJenisBarang.id),n="",null!=this.item.namaProduk&&(n=this.item.namaProduk);var l="";null!=this.item.jmlRows&&(l=this.item.jmlRows),this.apiService.get("logistik/get-stok-ruangan-detail?kelompokprodukid="+t+"&detailJenisProdukId="+e+"&jeniskprodukid="+a+"&namaproduk="+n+"&ruanganfk="+i+"&jmlRows="+l).subscribe(function(e){for(var t=e.detail,a=e.detailorder,i=0,n=0,l=0;l<t.length;l++){var r=t[l];r.no=l+1,parseFloat(r.qtyProduk),i+=parseFloat(r.qtyProduk),r.total=parseFloat(r.qtyProduk)*parseFloat(r.harga),n+=parseFloat(r.total),r.qtyorder=0;for(var d=0;d<a.length;d++){var s=a[d];s.objectprodukfk==r.kodeProduk&&(r.qtyProduk>s.qty?(r.qtyorder=s.qty,s.qty=0):(r.qtyorder=r.qtyProduk,s.qty=s.qty-r.qtyProduk))}r.qtyOnHand=r.qtyProduk,0!=r.qtyorder&&(r.qtyOnHand=r.qtyProduk-r.qtyorder)}o.item.jumlahStok=parseFloat(i).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),o.item.totalHarga=parseFloat(n).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),o.dataTable=t})}},{key:"cari",value:function(){this.loadData()}},{key:"onRowSelect",value:function(e){this.selected=e.data}},{key:"popUpTglKadaluarsa",value:function(){null!=this.selected?(this.item.tglKadaluarsa=s(this.dateNow).format("YYYY-MM-DD HH:mm"),this.pop_UbahTanggal=!0):this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"popUpTglKadaluarsa2",value:function(e){this.selected=e,this.popUpTglKadaluarsa()}},{key:"popUpAdjusmentStok2",value:function(e){this.selected=e,this.popUpAdjusmentStok()}},{key:"batalUbahTgl",value:function(){this.item.tglKadaluarsa=s(this.dateNow).format("YYYY-MM-DD HH:mm"),this.pop_UbahTanggal=!1}},{key:"simpanUbahTgl",value:function(){var e=this;if(null!=this.selected)if(null!=this.item.tglKadaluarsa){var t={norec_spd:this.selected.norec_spd,produkfk:this.selected.kodeProduk,nostruterimafk:this.selected.nostrukterimafk,tanggal:s(this.item.tglKadaluarsa).format("YYYY-MM-DD HH:mm")};this.apiService.post("logistik/update-tglkadaluarsa",t).subscribe(function(t){e.apiService.postLog("Input / Ubah Tanggal Kadaluarsa","norec transaksi stok",e.selected.norec_spd,"Input / Ubah  Tanggal Kadaluarsa Pada Produk "+e.selected.namaProduk).subscribe(function(e){}),e.item.tglKadaluarsa=s(e.dateNow).format("YYYY-MM-DD HH:mm"),e.pop_UbahTanggal=!1,e.loadData()})}else this.alertService.warn("Info","Tgl Kadaluarsa Tidak Boleh Kosong!");else this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"popUpAdjusmentStok",value:function(){null!=this.selected?(this.item.kodeProduk=this.selected.kodeProduk,this.item.namaProduk=this.selected.namaProduk,this.item.qtyReal=this.selected.qtyProduk,this.pop_AdjusmentStok=!0):this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"batalAdjusmentStok",value:function(){this.item.kodeProduk=void 0,this.item.namaProduk=void 0,this.item.qtyReal=void 0,this.item.QtyAjustment=void 0,this.pop_AdjusmentStok=!1}},{key:"simpanAdjusmentStok",value:function(){var e=this;null!=this.selected?null!=this.item.QtyAjustment?this.confirmationService.confirm({message:"Apakah Anda Yakin Akan Melakukan Adjusment Stok?",header:"Konfirmasi Adjusment Stok",icon:"pi pi-info-circle",accept:function(){e.confirmationService.close(),e.saveAdjusment()},reject:function(t){e.item.QtyAjustment=void 0,e.alertService.warn("Info, Konfirmasi","Adjusment Stok Dibatalkan!"),e.confirmationService.close()}}):this.alertService.warn("Info","Qty Adjusment Tidak Boleh Kosong!"):this.alertService.warn("Info","Data Belum Dipilih!")}},{key:"saveAdjusment",value:function(){var e=this,t={namaRuangan:this.item.dataRuangan.namaruangan,ruanganfk:this.item.dataRuangan.id,norec_spd:this.selected.norec_spd,produkfk:this.selected.kodeProduk,nostruterimafk:this.selected.nostrukterimafk,qtyreal:this.item.qtyReal,qtyad:parseFloat(this.item.QtyAjustment),harga:parseFloat(this.selected.harga)};this.apiService.post("logistik/save-adjusment-stok",t).subscribe(function(t){e.apiService.postLog("Adjusment Stok","norec transaksistok",e.selected.norec_spd,"Adjusment Stok Pada Produk "+e.selected.namaProduk).subscribe(function(e){}),e.item.kodeProduk=void 0,e.item.namaProduk=void 0,e.item.qtyReal=void 0,e.item.QtyAjustment=void 0,e.pop_AdjusmentStok=!1,e.loadData()})}}])&&t(i.prototype,n),o&&t(i,o),a}(),J.\u0275fac=function(e){return new(e||J)(u.Jb(c.a),u.Jb(c.b),u.Jb(r.a),u.Jb(r.h),u.Jb(b.a),u.Jb(p.a),u.Jb(m.a),u.Jb(l.a))},J.\u0275cmp=u.Db({type:J,selectors:[["app-daftar-stok-ruangan"]],features:[u.wb([r.a])],decls:85,vars:56,consts:[["header","Confirmation","icon","fa fa-question-circle"],[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-col-12","p-md-12"],[1,"p-grid"],[1,"p-col-12","p-md-2"],["for","input",1,"label"],["placeholder","Ruangan","optionLabel","namaruangan",3,"options","ngModel","filter","showClear","ngModelChange"],["placeholder","Detail Jenis Produk","optionLabel","detailjenisproduk",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["placeholder","Jenis Produk","optionLabel","jenisproduk",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["placeholder","Kelompok Produk","optionLabel","kelompokproduk",3,"options","ngModel","filter","showClear","ngModelChange"],[1,"p-col-12","p-md-3"],["type","text","pInputText","","placeholder","Nama Barang",3,"ngModel","ngModelChange","keyup.enter"],[1,"p-col-12","p-md-1"],[1,"p-col-12","p-md-12",2,"margin-top","10px"],["pButton","","type","submit","icon","pi pi-search","pTooltip","Cari",3,"click"],["styleClass","p-datatable-customers","scrollable","true","sortMode","multiple","selectionMode","single",3,"columns","value","selection","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks","selectionChange","onRowSelect"],["dt",""],["pTemplate","header"],["pTemplate","body"],[1,"p-col-12","p-md-2","p-md-offset-7"],["type","text","pInputText","","placeholder","Jumlah Stok","disabled","",3,"ngModel","ngModelChange"],[1,"p-col","p-md-2"],["type","text","pInputText","","placeholder","Total Harga","disabled","",3,"ngModel","ngModelChange"],[1,"p-col","p-md-1"],["type","text","pInputText","","placeholder","Jml Rows",3,"ngModel","ngModelChange","keyup.enter"],["header","Tanggal Kadaluarsa",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"p-col-12","p-md-4"],["yearRange","1980:2030","dateFormat","yy-mm-dd","hourFormat","24","placeholder","Tgl Kadaluarsa","appendTo","body",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","ngModelChange"],["pButton","","type","submit","icon","fa fa-floppy-o","pTooltip","Simpan Tgl Kadaluarsa","label","Simpan",3,"click"],["pButton","","type","submit","icon","fa fa-ban","pTooltip","Batal","label","Batal",2,"background-color","red",3,"click"],["type","text","pInputText","","placeholder","Kode Produk","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Nama Barang","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Qty Real","disabled","",3,"ngModel","ngModelChange"],["placeholder","Qty Adjustment","inputId","stacked",3,"ngModel","showButtons","ngModelChange"],[1,"p-col-12","p-md-3","p-md-offset-6"],["pButton","","type","submit","icon","fa fa-floppy-o","pTooltip","Simpan Adjusment Stok","label","Simpan",3,"click"],[3,"pSortableColumn","style",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[2,"width","100px"],["pButton","","type","button","icon","fa fa-calendar","pTooltip","Ubah Tgl Kadaluarsa","label","",1,"p-button-rounded","p-button-primary","p-mr-2",3,"click"],["pButton","","type","button","icon","pi pi-user-edit ","pTooltip","Adjustment Stok","label","",1,"p-button-rounded","p-mr-2",3,"click"],[3,"style",4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(e,t){1&e&&(u.Lb(0,"p-confirmDialog",0),u.Qb(1,"div",1),u.Qb(2,"div",2),u.Qb(3,"h4"),u.Jc(4,"Stok Barang Per Ruangan"),u.Pb(),u.Qb(5,"div",3),u.Qb(6,"div",4),u.Qb(7,"div",5),u.Qb(8,"label",6),u.Jc(9,"Ruangan"),u.Pb(),u.Qb(10,"p-dropdown",7),u.Yb("ngModelChange",function(e){return t.item.dataRuangan=e}),u.Pb(),u.Pb(),u.Qb(11,"div",5),u.Qb(12,"label",6),u.Jc(13,"Detail Jenis Produk"),u.Pb(),u.Qb(14,"p-dropdown",8),u.Yb("ngModelChange",function(e){return t.item.dataDjenisProduk=e})("onChange",function(){return t.isiJenisProduk()}),u.Pb(),u.Pb(),u.Qb(15,"div",5),u.Qb(16,"label",6),u.Jc(17,"Jenis Produk"),u.Pb(),u.Qb(18,"p-dropdown",9),u.Yb("ngModelChange",function(e){return t.item.dataJenisBarang=e})("onChange",function(){return t.isiKelompokProduk()}),u.Pb(),u.Pb(),u.Qb(19,"div",5),u.Qb(20,"label",6),u.Jc(21,"Kelompok Produk"),u.Pb(),u.Qb(22,"p-dropdown",10),u.Yb("ngModelChange",function(e){return t.item.dataKelompokBarang=e}),u.Pb(),u.Pb(),u.Qb(23,"div",11),u.Qb(24,"label",6),u.Jc(25,"Nama Produk"),u.Pb(),u.Qb(26,"input",12),u.Yb("ngModelChange",function(e){return t.item.namaProduk=e})("keyup.enter",function(){return t.cari()}),u.Pb(),u.Pb(),u.Qb(27,"div",13),u.Qb(28,"div",14),u.Qb(29,"button",15),u.Yb("click",function(){return t.cari()}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(30,"div",3),u.Qb(31,"p-table",16,17),u.Yb("selectionChange",function(e){return t.selected=e})("onRowSelect",function(e){return t.onRowSelect(e)}),u.Hc(33,x,2,1,"ng-template",18),u.Hc(34,R,5,3,"ng-template",19),u.Pb(),u.Pb(),u.Qb(35,"div",3),u.Qb(36,"div",4),u.Qb(37,"div",20),u.Qb(38,"label",6),u.Jc(39,"Jumlah Stok"),u.Pb(),u.Qb(40,"input",21),u.Yb("ngModelChange",function(e){return t.item.jumlahStok=e}),u.Pb(),u.Pb(),u.Qb(41,"div",22),u.Qb(42,"label",6),u.Jc(43,"Total Harga"),u.Pb(),u.Qb(44,"input",23),u.Yb("ngModelChange",function(e){return t.item.totalHarga=e}),u.Pb(),u.Pb(),u.Qb(45,"div",24),u.Qb(46,"label",6),u.Jc(47,"jml Rows"),u.Pb(),u.Qb(48,"input",25),u.Yb("ngModelChange",function(e){return t.item.jmlRows=e})("keyup.enter",function(){return t.cari()}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Lb(49,"div",3),u.Pb(),u.Pb(),u.Qb(50,"p-dialog",26),u.Yb("visibleChange",function(e){return t.pop_UbahTanggal=e}),u.Qb(51,"div",1),u.Qb(52,"div",4),u.Qb(53,"div",27),u.Qb(54,"p-calendar",28),u.Yb("ngModelChange",function(e){return t.item.tglKadaluarsa=e}),u.Pb(),u.Pb(),u.Qb(55,"div",27),u.Qb(56,"button",29),u.Yb("click",function(){return t.simpanUbahTgl()}),u.Pb(),u.Pb(),u.Qb(57,"div",27),u.Qb(58,"button",30),u.Yb("click",function(){return t.batalUbahTgl()}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(59,"p-dialog",26),u.Yb("visibleChange",function(e){return t.pop_AdjusmentStok=e}),u.Qb(60,"div",1),u.Qb(61,"div",3),u.Qb(62,"div",4),u.Qb(63,"div",11),u.Qb(64,"label",6),u.Jc(65,"kode Produk"),u.Pb(),u.Qb(66,"input",31),u.Yb("ngModelChange",function(e){return t.item.kodeProduk=e}),u.Pb(),u.Pb(),u.Qb(67,"div",11),u.Qb(68,"label",6),u.Jc(69,"Nama Produk"),u.Pb(),u.Qb(70,"input",32),u.Yb("ngModelChange",function(e){return t.item.namaProduk=e}),u.Pb(),u.Pb(),u.Qb(71,"div",11),u.Qb(72,"label",6),u.Jc(73,"Qty Real"),u.Pb(),u.Qb(74,"input",33),u.Yb("ngModelChange",function(e){return t.item.qtyReal=e}),u.Pb(),u.Pb(),u.Qb(75,"div",11),u.Qb(76,"label",6),u.Jc(77,"Qty Adjustment "),u.Pb(),u.Qb(78,"p-inputNumber",34),u.Yb("ngModelChange",function(e){return t.item.QtyAjustment=e}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Qb(79,"div",3),u.Qb(80,"div",4),u.Qb(81,"div",35),u.Qb(82,"button",36),u.Yb("click",function(){return t.simpanAdjusmentStok()}),u.Pb(),u.Pb(),u.Qb(83,"div",11),u.Qb(84,"button",30),u.Yb("click",function(){return t.batalAdjusmentStok()}),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb(),u.Pb()),2&e&&(u.xb(10),u.ic("options",t.listRuangan)("ngModel",t.item.dataRuangan)("filter",!0)("showClear",!0),u.xb(4),u.ic("options",t.listDetailJenisProduk)("ngModel",t.item.dataDjenisProduk)("filter",!0)("showClear",!0),u.xb(4),u.ic("options",t.listJenisBarang)("ngModel",t.item.dataJenisBarang)("filter",!0)("showClear",!0),u.xb(4),u.ic("options",t.listKelompokBarang)("ngModel",t.item.dataKelompokBarang)("filter",!0)("showClear",!0),u.xb(4),u.ic("ngModel",t.item.namaProduk),u.xb(5),u.ic("columns",t.column)("value",t.dataTable)("selection",t.selected)("rowHover",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",u.mc(53,K))("paginator",!0)("pageLinks",5),u.xb(9),u.ic("ngModel",t.item.jumlahStok),u.xb(4),u.ic("ngModel",t.item.totalHarga),u.xb(4),u.ic("ngModel",t.item.jmlRows),u.xb(2),u.Ec(u.mc(54,A)),u.ic("visible",t.pop_UbahTanggal)("modal",!0)("maximizable",!0)("draggable",!0)("resizable",!0),u.xb(4),u.ic("ngModel",t.item.tglKadaluarsa)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),u.xb(5),u.Ec(u.mc(55,B)),u.ic("visible",t.pop_AdjusmentStok)("modal",!0)("maximizable",!0)("draggable",!0)("resizable",!0),u.xb(7),u.ic("ngModel",t.item.kodeProduk),u.xb(4),u.ic("ngModel",t.item.namaProduk),u.xb(4),u.ic("ngModel",t.item.qtyReal),u.xb(4),u.ic("ngModel",t.item.QtyAjustment)("showButtons",!0))},directives:[g.a,h.a,k.g,k.h,k.a,f.a,P.b,v.a,y.h,r.k,w.a,Q.a,S.a,o.k,y.g,y.f,y.e,o.l],styles:[""]}),J)}],I=((Y=function t(){e(this,t)}).\u0275mod=u.Hb({type:Y}),Y.\u0275inj=u.Gb({factory:function(e){return new(e||Y)},imports:[[l.j.forChild(q)],l.j]}),Y),H=n("PCNd"),U=((D=function t(){e(this,t)}).\u0275mod=u.Hb({type:D}),D.\u0275inj=u.Gb({factory:function(e){return new(e||D)},imports:[[o.b,I,H.a]]}),D)}}])}();