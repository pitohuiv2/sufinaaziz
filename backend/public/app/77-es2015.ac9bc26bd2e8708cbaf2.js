(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{bSkc:function(t,e,a){"use strict";a.r(e),a.d(e,"DaftarStokRuanganModule",function(){return A});var i=a("ofXK"),o=a("tyNb"),n=a("7zfz"),l=a("1zoS"),r=a("wd/R"),d=a("fXoL"),s=a("EJUL"),u=a("U+s4"),b=a("G0w9"),p=a("ujBT"),c=a("Nf9I"),m=a("arFO"),h=a("3Pt+"),g=a("7kUa"),k=a("jIHw"),f=a("xlun"),P=a("rEr+"),v=a("/RsI"),w=a("eO1q"),Q=a("Ks7X");function y(t,e){if(1&t&&(d.Qb(0,"th",38),d.Jc(1),d.Lb(2,"p-sortIcon",39),d.Pb()),2&t){const t=e.$implicit;d.Fc("width: ",t.width,""),d.jc("pSortableColumn",t.field),d.xb(1),d.Lc(" ",t.header," "),d.xb(1),d.jc("field",t.field)}}function S(t,e){if(1&t&&(d.Qb(0,"tr"),d.Hc(1,y,3,6,"th",37),d.Pb()),2&t){const t=e.$implicit;d.xb(1),d.ic("ngForOf",t)}}function j(t,e){if(1&t&&(d.Qb(0,"span"),d.Jc(1),d.Pb()),2&t){const t=d.bc().$implicit,e=d.bc().$implicit,a=d.bc();d.xb(1),d.Lc(" ",a.formatRupiah(e[t.field],"")," ")}}function x(t,e){if(1&t&&(d.Qb(0,"span"),d.Jc(1),d.Pb()),2&t){const t=d.bc().$implicit,e=d.bc().$implicit;d.xb(1),d.Lc(" ",e[t.field],"")}}function M(t,e){if(1&t&&(d.Qb(0,"td"),d.Hc(1,j,2,1,"span",45),d.Hc(2,x,2,1,"span",45),d.Pb()),2&t){const t=e.$implicit;d.Fc("width: ",t.width,""),d.xb(1),d.ic("ngIf",null!=t.isCurrency),d.xb(1),d.ic("ngIf",null==t.isCurrency)}}function C(t,e){if(1&t){const t=d.Sb();d.Qb(0,"tr",40),d.Qb(1,"td",41),d.Qb(2,"button",42),d.Yb("click",function(){d.yc(t);const a=e.$implicit;return d.bc().popUpTglKadaluarsa2(a)}),d.Pb(),d.Qb(3,"button",43),d.Yb("click",function(){d.yc(t);const a=e.$implicit;return d.bc().popUpAdjusmentStok2(a)}),d.Pb(),d.Pb(),d.Hc(4,M,3,5,"td",44),d.Pb()}if(2&t){const t=e.columns,a=e.rowIndex;d.ic("pSelectableRow",e.$implicit)("pSelectableRowIndex",a),d.xb(4),d.ic("ngForOf",t)}}const T=function(){return[5,10,25,50]},R=function(){return{width:"650px",minWidth:"650px"}},J=function(){return{width:"800px",minWidth:"800px"}},Y=[{path:"",component:(()=>{class t{constructor(t,e,a,i,o,n,r,d){this.apiService=t,this.authService=e,this.confirmationService=a,this.messageService=i,this.cacheHelper=o,this.dateHelper=n,this.alertService=r,this.route=d,this.item={},this.page=l.b.get().page,this.rows=l.b.get().rows}ngOnInit(){this.dataLogin=this.authService.getDataLoginUser(),this.kelUser=this.dataLogin.kelompokUser.kelompokUser,this.dateNow=new Date,this.item.jmlRows=10,this.column=[{field:"no",header:"No",width:"65px"},{field:"noTerima",header:"No Terima",width:"140px"},{field:"kodeProduk",header:"Kode Produk",width:"140px"},{field:"namaProduk",header:"Nama Produk",width:"300px"},{field:"asalProduk",header:"Asal Produk",width:"180px"},{field:"qtyProduk",header:"Stok",width:"120px"},{field:"satuanStandar",header:"Satuan",width:"120px"},{field:"tglKadaluarsa",header:"Tgl Exp",width:"140px"},{field:"harga",header:"Harga",width:"140px",isCurrency:!0},{field:"noBatch",header:"No Batch",width:"140px"}],this.loadDataCombo()}loadDataCombo(){this.apiService.get("logistik/get-combo-logistik").subscribe(t=>{this.listRuangan=null!=this.dataLogin.mapLoginUserToRuangan?this.dataLogin.mapLoginUserToRuangan:t.ruangfarmasi,this.item.dataRuangan=this.listRuangan[0]}),this.apiService.get("logistik/get-combo-detailjenisproduk").subscribe(t=>{this.listDetailJenisProduk=t.detailjenisproduk})}isiJenisProduk(){null!=this.item.dataDjenisProduk&&(this.listJenisBarang=this.item.dataDjenisProduk.jenisproduk)}isiKelompokProduk(){null!=this.item.dataJenisBarang&&(this.listKelompokBarang=this.item.dataJenisBarang.kelompokproduk)}formatRupiah(t,e){return e+" "+parseFloat(t).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}loadData(){var t,e,a,i,o;i="",null!=this.item.dataRuangan&&(i=this.item.dataRuangan.id),t="",null!=this.item.dataDjenisProduk&&(t=this.item.dataDjenisProduk.id),e="",null!=this.item.dataKelompokBarang&&(e=this.item.dataKelompokBarang.id),a="",null!=this.item.dataJenisBarang&&(a=this.item.dataJenisBarang.id),o="",null!=this.item.namaProduk&&(o=this.item.namaProduk);var n="";null!=this.item.jmlRows&&(n=this.item.jmlRows),this.apiService.get("logistik/get-stok-ruangan-detail?kelompokprodukid="+e+"&detailJenisProdukId="+t+"&jeniskprodukid="+a+"&namaproduk="+o+"&ruanganfk="+i+"&jmlRows="+n).subscribe(t=>{var e=t.detail,a=t.detailorder,i=0,o=0;for(let n=0;n<e.length;n++){const t=e[n];t.no=n+1,parseFloat(t.qtyProduk),i+=parseFloat(t.qtyProduk),t.total=parseFloat(t.qtyProduk)*parseFloat(t.harga),o+=parseFloat(t.total),t.qtyorder=0;for(let e=0;e<a.length;e++){const i=a[e];i.objectprodukfk==t.kodeProduk&&(t.qtyProduk>i.qty?(t.qtyorder=i.qty,i.qty=0):(t.qtyorder=t.qtyProduk,i.qty=i.qty-t.qtyProduk))}t.qtyOnHand=t.qtyProduk,0!=t.qtyorder&&(t.qtyOnHand=t.qtyProduk-t.qtyorder)}this.item.jumlahStok=parseFloat(i).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),this.item.totalHarga=parseFloat(o).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,"),this.dataTable=e})}cari(){this.loadData()}onRowSelect(t){this.selected=t.data}popUpTglKadaluarsa(){null!=this.selected?(this.item.tglKadaluarsa=r(this.dateNow).format("YYYY-MM-DD HH:mm"),this.pop_UbahTanggal=!0):this.alertService.warn("Info","Data Belum Dipilih!")}popUpTglKadaluarsa2(t){this.selected=t,this.popUpTglKadaluarsa()}popUpAdjusmentStok2(t){this.selected=t,this.popUpAdjusmentStok()}batalUbahTgl(){this.item.tglKadaluarsa=r(this.dateNow).format("YYYY-MM-DD HH:mm"),this.pop_UbahTanggal=!1}simpanUbahTgl(){if(null!=this.selected)if(null!=this.item.tglKadaluarsa){var t={norec_spd:this.selected.norec_spd,produkfk:this.selected.kodeProduk,nostruterimafk:this.selected.nostrukterimafk,tanggal:r(this.item.tglKadaluarsa).format("YYYY-MM-DD HH:mm")};this.apiService.post("logistik/update-tglkadaluarsa",t).subscribe(t=>{this.apiService.postLog("Input / Ubah Tanggal Kadaluarsa","norec transaksi stok",this.selected.norec_spd,"Input / Ubah  Tanggal Kadaluarsa Pada Produk "+this.selected.namaProduk).subscribe(t=>{}),this.item.tglKadaluarsa=r(this.dateNow).format("YYYY-MM-DD HH:mm"),this.pop_UbahTanggal=!1,this.loadData()})}else this.alertService.warn("Info","Tgl Kadaluarsa Tidak Boleh Kosong!");else this.alertService.warn("Info","Data Belum Dipilih!")}popUpAdjusmentStok(){null!=this.selected?(this.item.kodeProduk=this.selected.kodeProduk,this.item.namaProduk=this.selected.namaProduk,this.item.qtyReal=this.selected.qtyProduk,this.pop_AdjusmentStok=!0):this.alertService.warn("Info","Data Belum Dipilih!")}batalAdjusmentStok(){this.item.kodeProduk=void 0,this.item.namaProduk=void 0,this.item.qtyReal=void 0,this.item.QtyAjustment=void 0,this.pop_AdjusmentStok=!1}simpanAdjusmentStok(){null!=this.selected?null!=this.item.QtyAjustment?this.confirmationService.confirm({message:"Apakah Anda Yakin Akan Melakukan Adjusment Stok?",header:"Konfirmasi Adjusment Stok",icon:"pi pi-info-circle",accept:()=>{this.confirmationService.close(),this.saveAdjusment()},reject:t=>{this.item.QtyAjustment=void 0,this.alertService.warn("Info, Konfirmasi","Adjusment Stok Dibatalkan!"),this.confirmationService.close()}}):this.alertService.warn("Info","Qty Adjusment Tidak Boleh Kosong!"):this.alertService.warn("Info","Data Belum Dipilih!")}saveAdjusment(){var t={namaRuangan:this.item.dataRuangan.namaruangan,ruanganfk:this.item.dataRuangan.id,norec_spd:this.selected.norec_spd,produkfk:this.selected.kodeProduk,nostruterimafk:this.selected.nostrukterimafk,qtyreal:this.item.qtyReal,qtyad:parseFloat(this.item.QtyAjustment),harga:parseFloat(this.selected.harga)};this.apiService.post("logistik/save-adjusment-stok",t).subscribe(t=>{this.apiService.postLog("Adjusment Stok","norec transaksistok",this.selected.norec_spd,"Adjusment Stok Pada Produk "+this.selected.namaProduk).subscribe(t=>{}),this.item.kodeProduk=void 0,this.item.namaProduk=void 0,this.item.qtyReal=void 0,this.item.QtyAjustment=void 0,this.pop_AdjusmentStok=!1,this.loadData()})}}return t.\u0275fac=function(e){return new(e||t)(d.Jb(s.a),d.Jb(s.b),d.Jb(n.a),d.Jb(n.h),d.Jb(u.a),d.Jb(b.a),d.Jb(p.a),d.Jb(o.a))},t.\u0275cmp=d.Db({type:t,selectors:[["app-daftar-stok-ruangan"]],features:[d.wb([n.a])],decls:85,vars:56,consts:[["header","Confirmation","icon","fa fa-question-circle"],[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-col-12","p-md-12"],[1,"p-grid"],[1,"p-col-12","p-md-2"],["for","input",1,"label"],["placeholder","Ruangan","optionLabel","namaruangan",3,"options","ngModel","filter","showClear","ngModelChange"],["placeholder","Detail Jenis Produk","optionLabel","detailjenisproduk",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["placeholder","Jenis Produk","optionLabel","jenisproduk",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["placeholder","Kelompok Produk","optionLabel","kelompokproduk",3,"options","ngModel","filter","showClear","ngModelChange"],[1,"p-col-12","p-md-3"],["type","text","pInputText","","placeholder","Nama Barang",3,"ngModel","ngModelChange","keyup.enter"],[1,"p-col-12","p-md-1"],[1,"p-col-12","p-md-12",2,"margin-top","10px"],["pButton","","type","submit","icon","pi pi-search","pTooltip","Cari",3,"click"],["styleClass","p-datatable-customers","scrollable","true","sortMode","multiple","selectionMode","single",3,"columns","value","selection","rowHover","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks","selectionChange","onRowSelect"],["dt",""],["pTemplate","header"],["pTemplate","body"],[1,"p-col-12","p-md-2","p-md-offset-7"],["type","text","pInputText","","placeholder","Jumlah Stok","disabled","",3,"ngModel","ngModelChange"],[1,"p-col","p-md-2"],["type","text","pInputText","","placeholder","Total Harga","disabled","",3,"ngModel","ngModelChange"],[1,"p-col","p-md-1"],["type","text","pInputText","","placeholder","Jml Rows",3,"ngModel","ngModelChange","keyup.enter"],["header","Tanggal Kadaluarsa",3,"visible","modal","maximizable","draggable","resizable","visibleChange"],[1,"p-col-12","p-md-4"],["yearRange","1980:2030","dateFormat","yy-mm-dd","hourFormat","24","placeholder","Tgl Kadaluarsa","appendTo","body",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","ngModelChange"],["pButton","","type","submit","icon","fa fa-floppy-o","pTooltip","Simpan Tgl Kadaluarsa","label","Simpan",3,"click"],["pButton","","type","submit","icon","fa fa-ban","pTooltip","Batal","label","Batal",2,"background-color","red",3,"click"],["type","text","pInputText","","placeholder","Kode Produk","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Nama Barang","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Qty Real","disabled","",3,"ngModel","ngModelChange"],["placeholder","Qty Adjustment","inputId","stacked",3,"ngModel","showButtons","ngModelChange"],[1,"p-col-12","p-md-3","p-md-offset-6"],["pButton","","type","submit","icon","fa fa-floppy-o","pTooltip","Simpan Adjusment Stok","label","Simpan",3,"click"],[3,"pSortableColumn","style",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[2,"width","100px"],["pButton","","type","button","icon","fa fa-calendar","pTooltip","Ubah Tgl Kadaluarsa","label","",1,"p-button-rounded","p-button-primary","p-mr-2",3,"click"],["pButton","","type","button","icon","pi pi-user-edit ","pTooltip","Adjustment Stok","label","",1,"p-button-rounded","p-mr-2",3,"click"],[3,"style",4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(d.Lb(0,"p-confirmDialog",0),d.Qb(1,"div",1),d.Qb(2,"div",2),d.Qb(3,"h4"),d.Jc(4,"Stok Barang Per Ruangan"),d.Pb(),d.Qb(5,"div",3),d.Qb(6,"div",4),d.Qb(7,"div",5),d.Qb(8,"label",6),d.Jc(9,"Ruangan"),d.Pb(),d.Qb(10,"p-dropdown",7),d.Yb("ngModelChange",function(t){return e.item.dataRuangan=t}),d.Pb(),d.Pb(),d.Qb(11,"div",5),d.Qb(12,"label",6),d.Jc(13,"Detail Jenis Produk"),d.Pb(),d.Qb(14,"p-dropdown",8),d.Yb("ngModelChange",function(t){return e.item.dataDjenisProduk=t})("onChange",function(){return e.isiJenisProduk()}),d.Pb(),d.Pb(),d.Qb(15,"div",5),d.Qb(16,"label",6),d.Jc(17,"Jenis Produk"),d.Pb(),d.Qb(18,"p-dropdown",9),d.Yb("ngModelChange",function(t){return e.item.dataJenisBarang=t})("onChange",function(){return e.isiKelompokProduk()}),d.Pb(),d.Pb(),d.Qb(19,"div",5),d.Qb(20,"label",6),d.Jc(21,"Kelompok Produk"),d.Pb(),d.Qb(22,"p-dropdown",10),d.Yb("ngModelChange",function(t){return e.item.dataKelompokBarang=t}),d.Pb(),d.Pb(),d.Qb(23,"div",11),d.Qb(24,"label",6),d.Jc(25,"Nama Produk"),d.Pb(),d.Qb(26,"input",12),d.Yb("ngModelChange",function(t){return e.item.namaProduk=t})("keyup.enter",function(){return e.cari()}),d.Pb(),d.Pb(),d.Qb(27,"div",13),d.Qb(28,"div",14),d.Qb(29,"button",15),d.Yb("click",function(){return e.cari()}),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(30,"div",3),d.Qb(31,"p-table",16,17),d.Yb("selectionChange",function(t){return e.selected=t})("onRowSelect",function(t){return e.onRowSelect(t)}),d.Hc(33,S,2,1,"ng-template",18),d.Hc(34,C,5,3,"ng-template",19),d.Pb(),d.Pb(),d.Qb(35,"div",3),d.Qb(36,"div",4),d.Qb(37,"div",20),d.Qb(38,"label",6),d.Jc(39,"Jumlah Stok"),d.Pb(),d.Qb(40,"input",21),d.Yb("ngModelChange",function(t){return e.item.jumlahStok=t}),d.Pb(),d.Pb(),d.Qb(41,"div",22),d.Qb(42,"label",6),d.Jc(43,"Total Harga"),d.Pb(),d.Qb(44,"input",23),d.Yb("ngModelChange",function(t){return e.item.totalHarga=t}),d.Pb(),d.Pb(),d.Qb(45,"div",24),d.Qb(46,"label",6),d.Jc(47,"jml Rows"),d.Pb(),d.Qb(48,"input",25),d.Yb("ngModelChange",function(t){return e.item.jmlRows=t})("keyup.enter",function(){return e.cari()}),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Lb(49,"div",3),d.Pb(),d.Pb(),d.Qb(50,"p-dialog",26),d.Yb("visibleChange",function(t){return e.pop_UbahTanggal=t}),d.Qb(51,"div",1),d.Qb(52,"div",4),d.Qb(53,"div",27),d.Qb(54,"p-calendar",28),d.Yb("ngModelChange",function(t){return e.item.tglKadaluarsa=t}),d.Pb(),d.Pb(),d.Qb(55,"div",27),d.Qb(56,"button",29),d.Yb("click",function(){return e.simpanUbahTgl()}),d.Pb(),d.Pb(),d.Qb(57,"div",27),d.Qb(58,"button",30),d.Yb("click",function(){return e.batalUbahTgl()}),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(59,"p-dialog",26),d.Yb("visibleChange",function(t){return e.pop_AdjusmentStok=t}),d.Qb(60,"div",1),d.Qb(61,"div",3),d.Qb(62,"div",4),d.Qb(63,"div",11),d.Qb(64,"label",6),d.Jc(65,"kode Produk"),d.Pb(),d.Qb(66,"input",31),d.Yb("ngModelChange",function(t){return e.item.kodeProduk=t}),d.Pb(),d.Pb(),d.Qb(67,"div",11),d.Qb(68,"label",6),d.Jc(69,"Nama Produk"),d.Pb(),d.Qb(70,"input",32),d.Yb("ngModelChange",function(t){return e.item.namaProduk=t}),d.Pb(),d.Pb(),d.Qb(71,"div",11),d.Qb(72,"label",6),d.Jc(73,"Qty Real"),d.Pb(),d.Qb(74,"input",33),d.Yb("ngModelChange",function(t){return e.item.qtyReal=t}),d.Pb(),d.Pb(),d.Qb(75,"div",11),d.Qb(76,"label",6),d.Jc(77,"Qty Adjustment "),d.Pb(),d.Qb(78,"p-inputNumber",34),d.Yb("ngModelChange",function(t){return e.item.QtyAjustment=t}),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(79,"div",3),d.Qb(80,"div",4),d.Qb(81,"div",35),d.Qb(82,"button",36),d.Yb("click",function(){return e.simpanAdjusmentStok()}),d.Pb(),d.Pb(),d.Qb(83,"div",11),d.Qb(84,"button",30),d.Yb("click",function(){return e.batalAdjusmentStok()}),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb()),2&t&&(d.xb(10),d.ic("options",e.listRuangan)("ngModel",e.item.dataRuangan)("filter",!0)("showClear",!0),d.xb(4),d.ic("options",e.listDetailJenisProduk)("ngModel",e.item.dataDjenisProduk)("filter",!0)("showClear",!0),d.xb(4),d.ic("options",e.listJenisBarang)("ngModel",e.item.dataJenisBarang)("filter",!0)("showClear",!0),d.xb(4),d.ic("options",e.listKelompokBarang)("ngModel",e.item.dataKelompokBarang)("filter",!0)("showClear",!0),d.xb(4),d.ic("ngModel",e.item.namaProduk),d.xb(5),d.ic("columns",e.column)("value",e.dataTable)("selection",e.selected)("rowHover",!0)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",d.mc(53,T))("paginator",!0)("pageLinks",5),d.xb(9),d.ic("ngModel",e.item.jumlahStok),d.xb(4),d.ic("ngModel",e.item.totalHarga),d.xb(4),d.ic("ngModel",e.item.jmlRows),d.xb(2),d.Ec(d.mc(54,R)),d.ic("visible",e.pop_UbahTanggal)("modal",!0)("maximizable",!0)("draggable",!0)("resizable",!0),d.xb(4),d.ic("ngModel",e.item.tglKadaluarsa)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),d.xb(5),d.Ec(d.mc(55,J)),d.ic("visible",e.pop_AdjusmentStok)("modal",!0)("maximizable",!0)("draggable",!0)("resizable",!0),d.xb(7),d.ic("ngModel",e.item.kodeProduk),d.xb(4),d.ic("ngModel",e.item.namaProduk),d.xb(4),d.ic("ngModel",e.item.qtyReal),d.xb(4),d.ic("ngModel",e.item.QtyAjustment)("showButtons",!0))},directives:[c.a,m.a,h.g,h.h,h.a,g.a,k.b,f.a,P.h,n.k,v.a,w.a,Q.a,i.k,P.g,P.f,P.e,i.l],styles:[""]}),t})()}];let D=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(e){return new(e||t)},imports:[[o.j.forChild(Y)],o.j]}),t})();var K=a("PCNd");let A=(()=>{class t{}return t.\u0275mod=d.Hb({type:t}),t.\u0275inj=d.Gb({factory:function(e){return new(e||t)},imports:[[i.b,D,K.a]]}),t})()}}]);