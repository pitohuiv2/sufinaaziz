(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{I2Rk:function(a,e,t){"use strict";t.r(e),t.d(e,"InputResepNonlayananModule",function(){return O});var i=t("ofXK"),n=t("tyNb"),s=t("7zfz"),o=t("wd/R"),l=t("fXoL"),r=t("EJUL"),h=t("U+s4"),d=t("G0w9"),u=t("ujBT"),m=t("7CaW"),p=t("eO1q"),b=t("3Pt+"),c=t("arFO"),g=t("7kUa"),k=t("Ji6n"),f=t("V5BG"),P=t("Ks7X"),v=t("jIHw"),Q=t("xlun"),M=t("rEr+"),x=t("LuMj");function S(a,e){if(1&a){const a=l.Sb();l.Qb(0,"div",52),l.Qb(1,"p-radioButton",53),l.Yb("ngModelChange",function(e){return l.yc(a),l.bc().item.jenisKemasan=e})("onClick",function(){l.yc(a);const e=l.bc();return e.clickRadio(e.item.jenisKemasan)}),l.Pb(),l.Qb(2,"label",54),l.Jc(3),l.Pb(),l.Pb()}if(2&a){const a=e.$implicit,t=l.bc();l.xb(1),l.ic("inputId",a.id)("value",a)("ngModel",t.item.jenisKemasan),l.xb(1),l.ic("for",a.id),l.xb(1),l.Kc(a.jeniskemasan)}}function j(a,e){if(1&a){const a=l.Sb();l.Qb(0,"div",30),l.Qb(1,"label",6),l.Jc(2,"Jumlah "),l.Pb(),l.Qb(3,"p-inputNumber",55),l.Yb("ngModelChange",function(e){return l.yc(a),l.bc().item.jumlahxmakan=e})("onInput",function(e){return l.yc(a),l.bc().onChangeJmlXMakan(e)}),l.Pb(),l.Pb()}if(2&a){const a=l.bc();l.xb(3),l.ic("ngModel",a.item.jumlahxmakan)("showButtons",!0)}}function C(a,e){if(1&a){const a=l.Sb();l.Qb(0,"div",30),l.Qb(1,"label",6),l.Jc(2,"Dosis "),l.Pb(),l.Qb(3,"input",56),l.Yb("ngModelChange",function(e){return l.yc(a),l.bc().item.dosis=e})("input",function(e){return l.yc(a),l.bc().onChangeJmlXMakan(e.target.value)}),l.Pb(),l.Pb()}if(2&a){const a=l.bc();l.xb(3),l.ic("ngModel",a.item.dosis)}}function w(a,e){if(1&a){const a=l.Sb();l.Qb(0,"div",30),l.Qb(1,"label",6),l.Jc(2,"Jenis Racikan "),l.Pb(),l.Qb(3,"p-dropdown",57),l.Yb("ngModelChange",function(e){return l.yc(a),l.bc().item.jenisRacikan=e}),l.Pb(),l.Pb()}if(2&a){const a=l.bc();l.xb(3),l.ic("options",a.listJenisRacikan)("ngModel",a.item.jenisRacikan)("filter",!0)("showClear",!0)}}function R(a,e){if(1&a){const a=l.Sb();l.Qb(0,"div",58),l.Qb(1,"div",2),l.Qb(2,"div",59),l.Qb(3,"p-checkbox",60),l.Yb("ngModelChange",function(t){l.yc(a);const i=e.$implicit;return l.bc().item.aturanCheck[i.id]=t})("onChange",function(){return l.yc(a),l.bc().getSelected()}),l.Pb(),l.Pb(),l.Qb(4,"div",61),l.Qb(5,"label",54),l.Jc(6),l.Pb(),l.Pb(),l.Pb(),l.Pb()}if(2&a){const a=e.$implicit,t=l.bc();l.xb(3),l.jc("inputId",a.id),l.ic("ngModel",t.item.aturanCheck[a.id]),l.xb(2),l.ic("for",a.id),l.xb(1),l.Lc(" ",a.nama,"")}}function y(a,e){if(1&a&&(l.Qb(0,"th"),l.Jc(1),l.Pb()),2&a){const a=e.$implicit;l.Fc("width: ",a.width,""),l.xb(1),l.Lc(" ",a.header," ")}}function D(a,e){if(1&a&&(l.Qb(0,"tr"),l.Lb(1,"th",62),l.Hc(2,y,2,4,"th",63),l.Pb()),2&a){const a=e.$implicit;l.xb(2),l.ic("ngForOf",a)}}function K(a,e){if(1&a&&(l.Qb(0,"span"),l.Jc(1),l.Pb()),2&a){const a=l.bc().$implicit,e=l.bc().$implicit,t=l.bc();l.xb(1),l.Lc(" ",t.formatRupiah(e[a.field],""),"")}}function T(a,e){if(1&a&&(l.Qb(0,"span"),l.Jc(1),l.Pb()),2&a){const a=l.bc().$implicit,e=l.bc().$implicit;l.xb(1),l.Lc(" ",e[a.field],"")}}function J(a,e){if(1&a&&(l.Qb(0,"td"),l.Hc(1,K,2,1,"span",66),l.Hc(2,T,2,1,"span",66),l.Pb()),2&a){const a=e.$implicit;l.Fc("width: ",a.width,""),l.xb(1),l.ic("ngIf",null!=a.isCurrency),l.xb(1),l.ic("ngIf",null==a.isCurrency)}}function I(a,e){if(1&a){const a=l.Sb();l.Qb(0,"tr"),l.Qb(1,"td",62),l.Qb(2,"button",64),l.Yb("click",function(){l.yc(a);const t=e.$implicit;return l.bc().editD(t)}),l.Pb(),l.Qb(3,"button",65),l.Yb("click",function(){l.yc(a);const t=e.$implicit;return l.bc().hapusD(t)}),l.Pb(),l.Pb(),l.Hc(4,J,3,5,"td",63),l.Pb()}if(2&a){const a=e.columns;l.xb(4),l.ic("ngForOf",a)}}function Y(a,e){if(1&a&&(l.Qb(0,"tr"),l.Qb(1,"td",67),l.Jc(2,"Grand Total : "),l.Pb(),l.Qb(3,"td"),l.Jc(4),l.Pb(),l.Pb()),2&a){const a=l.bc();l.xb(4),l.Lc(" \xa0",a.item.totalSubTotal,"")}}const F=function(){return[5,10,25,50]},N=[{path:"",component:(()=>{class a{constructor(a,e,t,i,n,s,o,l,r){this.apiService=a,this.authService=e,this.confirmationService=t,this.messageService=i,this.cacheHelper=n,this.dateHelper=s,this.alertService=o,this.route=l,this.router=r,this.params={},this.item={pasien:{},tglresep:new Date,aturanCheck:[],rke:1},this.skeleton=[],this.maxDateValue=new Date,this.headData={},this.dataProdukDetail=[],this.listSatuan=[],this.statusTambah=!0,this.listDataSigna=[{id:1,nama:"P",isChecked:!1},{id:2,nama:"S",isChecked:!1},{id:3,nama:"Sr",isChecked:!1},{id:4,nama:"M",isChecked:!1}],this.hrg1=0,this.columnGrid=[],this.dataSource=[],this.data2=[],this.strStatus=0,this.isPemakaianObatAlkes=!1,this.tambah=function(){if(0!=this.statusTambah)if(null!=this.item.ruangan)if(null!=this.item.penulisResep)if(null!=this.item.tglresep)if(0!=this.item.jumlah)if(null!=this.item.jenisKemasan)if(null!=this.item.produk)if(null!=this.item.satuan)if(null!=this.item.aturanpakaitxt){var a=0;1==this.item.SelectedObatKronis&&(a=1);var e="";this.item.KeteranganPakai&&(e=this.item.KeteranganPakai);var t=1;"Racikan"==this.item.jenisKemasan.jeniskemasan&&(t=this.item.dosis);var i,n=null;null!=this.item.jenisRacikan&&(n=this.item.jenisRacikan.id),i=null==this.dataSource?1:this.data2.length+1;var s={};if(this.disabledRuangan=!0,null!=this.item.no)for(var o=this.data2.length-1;o>=0;o--)this.data2[o].no==this.item.no&&(s.no=this.item.no,s.generik=null,s.hargajual=this.item.hargaSatuan,s.jenisobatfk=n,s.stock=this.item.stok,s.harganetto=this.item.hargaSatuan,s.nostrukterimafk=this.noTerima,s.rke=this.item.rke,s.jeniskemasanfk=this.item.jenisKemasan.id,s.jeniskemasan=this.item.jenisKemasan.jeniskemasan,s.aturanpakaifk=0,s.aturanpakai=this.item.aturanpakaitxt,s.ispagi=this.item.chkp,s.issiang=this.item.chks,s.issore=this.item.chksr,s.ismalam=this.item.chkm,s.asalprodukfk=0,s.asalproduk="",s.produkfk=this.item.produk.id,s.namaproduk=this.item.produk.namaproduk,s.nilaikonversi=this.item.nilaiKonversi,s.satuanstandarfk=this.item.satuan.ssid,s.satuanstandar=this.item.satuan.satuanstandar,s.satuanviewfk=this.item.satuan.ssid,s.satuanview=this.item.satuan.satuanstandar,s.jmlstok=this.item.stok,s.jumlah=this.item.jumlah,s.hargasatuan=this.item.hargaSatuan,s.hargadiscount=null!=this.hargaDiskon?this.hargaDiskon:0,s.persendiscount=null!=this.item.hargaDiskon?this.item.hargaDiskon:0,s.total=this.item.hargaTotal,s.dosis=t,s.jumlahxmakan=this.item.jumlahxmakan,s.jmldosis=String(this.item.jumlah/t)+"/"+String(t),s.keterangan=e,s.satuanresepfk=null!=this.item.satuanresep?this.item.satuanresep.id:null,s.satuanresep=null!=this.item.satuanresep?this.item.satuanresep.satuanresep:null,s.tglkadaluarsa=null!=this.tglkadaluarsa?this.tglkadaluarsa:null,s.isoutofstok=!1,s.iskronis=a,s.belumlengkap=!1,this.data2[o]=s,this.dataSource=this.data2);else{s={no:i,generik:null,hargajual:this.item.hargaSatuan,jenisobatfk:n,stock:this.item.stok,harganetto:this.item.hargaSatuan,nostrukterimafk:this.noTerima,rke:this.item.rke,jeniskemasanfk:this.item.jenisKemasan.id,jeniskemasan:this.item.jenisKemasan.jeniskemasan,aturanpakaifk:0,aturanpakai:this.item.aturanpakaitxt,ispagi:this.item.chkp,issiang:this.item.chks,issore:this.item.chksr,ismalam:this.item.chkm,asalprodukfk:0,asalproduk:"",produkfk:this.item.produk.id,namaproduk:this.item.produk.namaproduk,nilaikonversi:this.item.nilaiKonversi,satuanstandarfk:this.item.satuan.ssid,satuanstandar:this.item.satuan.satuanstandar,satuanviewfk:this.item.satuan.ssid,satuanview:this.item.satuan.satuanstandar,jmlstok:this.item.stok,jumlah:this.item.jumlah,hargasatuan:this.item.hargaSatuan,hargadiscount:null!=this.hargaDiskon?this.hargaDiskon:0,persendiscount:null!=this.item.hargaDiskon?this.item.hargaDiskon:0,total:this.item.hargaTotal,dosis:t,jumlahxmakan:this.item.jumlahxmakan,jmldosis:String(this.item.jumlah/t)+"/"+String(t),keterangan:e,satuanresepfk:null!=this.item.satuanresep?this.item.satuanresep.id:null,satuanresep:null!=this.item.satuanresep?this.item.satuanresep.satuanresep:null,tglkadaluarsa:null!=this.tglkadaluarsa?this.tglkadaluarsa:null,isoutofstok:!1,iskronis:a,belumlengkap:!1},this.data2.push(s),this.dataSource=this.data2;var l=0;for(o=this.data2.length-1;o>=0;o--)l+=parseFloat(this.data2[o].total);this.item.totalSubTotal=this.formatRupiah(l,"Rp.")}"Racikan"!=this.item.jenisKemasan.jeniskemasan&&(this.item.rke=parseFloat(this.item.rke)+1),this.disabledRuangan=!0,this.kosongkan(),this.clear()}else this.alertService.error("Info","Aturan Pakai Belum diisi!!");else this.alertService.error("Info","Pilih Satuan terlebih dahulu!!");else this.alertService.error("Info","Pilih Produk terlebih dahulu!!");else this.alertService.error("Info","Pilih Jenis Kemasan terlebih dahulu!!");else this.alertService.error("Info","Jumlah harus di isi!");else this.alertService.error("Info","Data Tanggal Resep Masih Kosong!");else this.alertService.error("Info","Data Penulis Resep Masih Kosong!");else this.alertService.error("Info","Data Ruangan Masih Kosong!")}}ngOnInit(){this.isSimpan=!1,this.dateNow=new Date,this.dataLogin=this.authService.getDataLoginUser(),this.kelUser=this.dataLogin.kelompokUser.kelompokUser,this.item.SelectedResepPulang=!1,this.item.SelectedObatKronis=!1,this.hargaDiskon=0,this.loadColumn(),this.loadCombo(),this.firstLoad()}formatRupiah(a,e){return e+" "+parseFloat(a).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}loadColumn(){this.columnGrid=[{field:"no",header:"No",width:"80px"},{field:"rke",header:"R/Ke",width:"100px"},{field:"jeniskemasan",header:"Kemasan",width:"120px"},{field:"jmldosis",header:"Jml/Dosis",width:"120px"},{field:"aturanpakai",header:"Aturan Pakai",width:"120px"},{field:"satuanresep",header:"Satuan Resep",width:"120px"},{field:"namaproduk",header:"Produk",width:"120px"},{field:"satuanstandar",header:"Satuan",width:"100px"},{field:"jumlah",header:"Jumlah",width:"150px"},{field:"hargasatuan",header:"Harga",width:"150px",isCurrency:!0},{field:"total",header:"Total",width:"150px",isCurrency:!0},{field:"keterangan",header:"Keterangan",width:"150px"},{field:"tglkadaluarsa",header:"Tgl Exp",width:"140px"}]}loadCombo(){this.apiService.get("farmasi/get-combo-farmasi").subscribe(a=>{var e=a;this.listRuangan=null!=this.dataLogin.mapLoginUserToRuangan?this.dataLogin.mapLoginUserToRuangan:e.ruangfarmasi,this.listPenulisResep=e.dokter,this.listJenisKelamin=e.jeniskelamin}),this.apiService.get("farmasi/get-combo-resep").subscribe(a=>{this.listJenisKemasan=a.jeniskemasan,this.listAsalProduk=a.asalproduk,this.listsatuanresep=a.satuanresep,this.listJenisRacikan=a.jenisracikan,this.item.jenisKemasan=a.jeniskemasan[1]})}firstLoad(){this.route.params.subscribe(a=>{null!=a.norec_resep||""!=a.norec_rp?(this.params.norec_resep=a.norec_resep,this.norec_resep=a.norec_resep):this.norec_resep="",this.loadData()})}loadData(){"-"!=this.norec_resep&&this.apiService.get("farmasi/get-detail-obat-bebas?norecResep="+this.norec_resep).subscribe(a=>{var e=a.detailresep,t=a.pelayananPasien,i=0;this.item.pasien=e,this.item.pasien.tgllahir=o(new Date(e.tgllahir)).format("YYYY-MM-DD HH:mm"),this.item.pasien.jeniskelamin={id:e.jkid,jeniskelamin:e.jeniskelamin},this.item.nomorResep=e.nostruk,this.item.ruangan={id:e.id,namaruangan:e.namaruangan},this.disabledRuangan=!0,this.item.penulisResep={id:e.pgid,namalengkap:e.namalengkap},this.item.tglresep=o(e.tglresep).format("YYYY-MM-DD HH:mm");for(let n=0;n<t.length;n++){const a=t[n];a.no=n+1,i+=parseFloat(a.total)}this.data2=t,this.item.totalSubTotal=this.formatRupiah(i,"Rp."),this.dataSource=this.data2})}clickRadio(a){"Racikan"==a.jeniskemasan?(this.showRacikanDose=!0,delete this.item.jumlahxmakan,delete this.item.dosis,delete this.item.jenisRacikan,delete this.item.sediaan,delete this.item.kekuatan):this.showRacikanDose=!1}cariPasien(){if(""==this.item.pasien.norm||"-"==this.item.pasien.norm)return this.item.pasien.namapasien=void 0,this.item.pasien.jeniskelamin=void 0,this.item.pasien.tgllahir=void 0,this.item.pasien.notelepon=void 0,void(this.item.pasien.alamatlengkap=void 0);this.apiService.get("general/get-detail-pasien?nocm="+this.item.pasien.norm).subscribe(a=>{null!=a&&(this.item.pasien=a,this.item.pasien.tgllahir=new Date(o(a.tgllahir).format("YYYY-MM-DD HH:mm")),this.item.pasien.jeniskelamin={id:a.jkid,jeniskelamin:a.jeniskelamin})})}ObatKronis(a){this.item.SelectedObatKronis=1==a.checked}filterProduk(a){this.apiService.get("farmasi/get-produk-resep?namaproduk="+a.query).subscribe(a=>{this.listProduk=a})}getSatuan(){null!=this.item.produk.id&&this.GETKONVERSI()}GETKONVERSI(){this.listSatuan=this.item.produk.konversisatuan,0==this.listSatuan.length&&(this.listSatuan=[{ssid:this.item.produk.ssid,satuanstandar:this.item.produk.satuanstandar}]),this.item.satuan={ssid:this.item.produk.ssid,satuanstandar:this.item.produk.satuanstandar},this.item.nilaiKonversi=1,null!=this.item.ruangan&&(this.statusTambah=!1,this.apiService.get("general/get-produkdetail-general?produkfk="+this.item.produk.id+"&ruanganfk="+this.item.ruangan.id).subscribe(a=>{this.dataProdukDetail=a.detail,this.item.stok=a.jmlstok/this.item.nilaiKonversi,this.onChangeKonversi(),0==a.kekuatan&&(a.kekuatan=1),this.item.kekuatan=a.kekuatan,this.item.sediaan=a.sediaan,this.tglkadaluarsa=o(this.dataProdukDetail[0].tglkadaluarsa).format("YYYY-MM-DD HH:mm"),this.dataProdukDetail.length>0&&(null!=this.dataSelected?(this.item.nilaiKonversi=this.dataSelected.nilaikonversi,this.item.stok=this.dataSelected.jmlstok,this.item.jumlah=this.dataSelected.jumlah,this.item.hargaSatuan=this.dataSelected.hargasatuan,0!=this.dataSelected.hargadiscount?(this.hargaDiskon=parseFloat(this.item.hargaSatuan)-parseFloat(this.dataSelected.hargadiscount),this.item.hargaDiskon=parseFloat(this.item.hargaSatuan)/parseFloat(this.dataSelected.hargadiscount)):(this.hargaDiskon=0,this.item.hargaDiskon=0),this.item.hargaTotal=this.dataSelected.total,null!=this.item.kekuatan&&0!=this.item.kekuatan&&(this.item.jumlahxmakan=parseFloat(this.item.jumlah)/parseFloat(this.item.dosis)*parseFloat(this.item.kekuatan))):(this.hargaDiskon=0,this.item.hargaDiskon=0)),this.statusTambah=!0,this.gettotal()}))}onChangeQty(a){this.item.jumlah=a.value,this.gettotal()}onChangeJmlXMakan(a){null!=this.item.kekuatan&&0!=this.item.kekuatan||(this.item.kekuatan=1),this.item.jumlah=parseFloat(this.item.jumlahxmakan)*parseFloat(this.item.dosis)/parseFloat(this.item.kekuatan)}onChangeKonversi(){this.item.stok>0&&(this.item.stok=parseFloat(this.item.stok)*parseFloat(this.item.nilaiKonversi),this.item.jumlah=1,this.item.hargaSatuan=0,this.item.hargaDiskon=0,this.item.hargaTotal=0)}onChangeDiskon(a){this.item.hargaDiskon=parseFloat(a.value),this.hargaDiskon=0;var e=this.item.hargaSatuan-this.item.hargaSatuan*this.item.hargaDiskon/100;this.hargaDiskon=e,this.item.hargaTotal=this.item.jumlah*e}getNilaiKonversi(){this.item.nilaiKonversi=this.item.satuan.nilaikonversi}gettotal(){for(var a=!1,e=0;e<this.dataProdukDetail.length;e++)if(a=!1,this.item.jumlah*parseFloat(this.item.nilaiKonversi)>0){this.hrg1=Math.round(parseFloat(this.dataProdukDetail[e].hargajual)*parseFloat(this.item.nilaiKonversi)),this.item.hargaSatuan=parseFloat(this.hrg1),this.item.hargaTotal=this.item.jumlah*this.hrg1,this.noTerima=this.dataProdukDetail[e].norec,a=!0;break}0==a&&(this.item.hargaSatuan=0,this.item.total=0,this.noTerima=""),0==this.item.jumlah&&(this.item.hargaSatuan=0)}kosongkan(){this.dataSelected=void 0,delete this.item.produk,delete this.item.satuan,delete this.item.nilaiKonversi,delete this.item.sediaan,delete this.item.kekuatan,this.item.stok=0,this.item.jumlah=1,this.item.no=void 0,this.item.hargaSatuan=0,delete this.item.satuanresep,delete this.item.KeteranganPakai,this.item.hargaDiskon=0,this.item.hargaTotal=0,this.hargaDiskon=0,this.tglkadaluarsa=void 0}clear(){"Racikan"!=this.item.jenisKemasan.jeniskemasan&&delete this.item.jenisRacikan}getSelected(){let a=0;if(this.item.aturanCheck.length>0)for(var e=Object.keys(this.item.aturanCheck),t=0;t<e.length;t++){const a=e[t];1==this.item.aturanCheck[parseInt(a)]?("1"==a&&(this.item.chkp=1),"2"==a&&(this.item.chks=1),"3"==a&&(this.item.chksr=1),"4"==a&&(this.item.chkm=1)):("1"==a&&(this.item.chkp=0),"2"==a&&(this.item.chks=0),"3"==a&&(this.item.chksr=0),"4"==a&&(this.item.chkm=0))}1==this.item.chkp&&(a+=1),1==this.item.chks&&(a+=1),1==this.item.chksr&&(a+=1),1==this.item.chkm&&(a+=1),this.item.aturanpakaitxt=a+"x1",0==a&&(this.item.aturanpakaitxt="")}batal(){this.kosongkan(),this.clear()}batalGrid(){this.disabledRuangan=!1,this.kosongkan(),this.clear(),this.data2=[],this.dataSource=void 0}hapusD(a){for(var e=this.data2.length-1;e>=0;e--)if(this.data2[e].no==a.no){this.data2.splice(e,1);var t=0;for(e=this.data2.length-1;e>=0;e--)t+=parseFloat(this.data2[e].total),this.data2[e].no=e+1;this.dataSource=this.data2,this.item.totalSubTotal=t}"Racikan"!=this.item.jenisKemasan.jeniskemasan&&(this.item.rke=parseFloat(this.item.rke)-1),this.kosongkan()}editD(a){if(0!=this.statusTambah){var e=[];this.dataSelected=a,this.item.no=a.no,this.item.rke=a.rke,null!=a.jenisobatfk&&this.apiService.get("farmasi/get-jenis-obat?jrid="+a.jenisobatfk).subscribe(a=>{0!=a.data.length&&(this.item.jenisRacikan={id:a.data[0].id,jenisracikan:a.data[0].jenisracikan})}),null!=this.item.jenisKemasan&&this.item.jenisKemasan.id==a.jeniskemasanfk||(this.item.jenisKemasan={id:a.jeniskemasanfk,jeniskemasan:a.jeniskemasan}),this.item.satuanresep={id:a.satuanresepfk,satuanresep:a.satuanresep},this.item.jumlahxmakan=a.jumlahxmakan,this.item.dosis=a.dosis,this.item.aturanPakai={id:a.aturanpakaifk,name:a.aturanpakai},this.item.aturanpakaitxt=a.aturanpakai,this.item.KeteranganPakai=a.keterangan,this.item.aturanCheck=[],null!=a.ispagi&&"0"!=a.ispagi&&(this.item.aturanCheck[1]=!0),null!=a.issiang&&"0"!=a.issiang&&(this.item.aturanCheck[2]=!0),null!=a.issore&&"0"!=a.issore&&(this.item.aturanCheck[3]=!0),null!=a.ismalam&&"0"!=a.ismalam&&(this.item.aturanCheck[4]=!0),this.getSelected(),this.item.asal={id:a.asalprodukfk,asalproduk:a.asalproduk},this.apiService.get("farmasi/get-produk-resep?idproduk="+a.produkfk).subscribe(t=>{this.listProduk=t;for(var i=this.listProduk.length-1;i>=0;i--)if(this.listProduk[i].id==a.produkfk){e=this.listProduk[i];break}this.item.produk=e,this.GETKONVERSI()})}}Kembali(){window.history.back()}save(){if(this.isSimpan=!0,null!=this.item.ruangan)if(null!=this.item.penulisResep)if(null!=this.item.tglresep)if(null!=this.item.pasien.namapasien)if(0!=this.data2.length){for(var a=0,e=this.data2.length-1;e>=0;e--)a+=parseFloat(this.data2[e].total);var t={noresep:this.norec_resep,tglresep:o(this.item.tglresep).format("YYYY-MM-DD HH:mm:ss"),nocm:null!=this.item.pasien.norm?this.item.pasien.norm:"-",namapasien:this.item.pasien.namapasien,penulisresepfk:this.item.penulisResep.id,ruanganfk:this.item.ruangan.id,keteranganlainnya:"Resep Non Layanan",totalharusdibayar:a,tglLahir:null!=this.item.pasien.tgllahir?o(this.item.pasien.tgllahir).format("YYYY-MM-DD HH:mm"):null,noTelepon:null!=this.item.pasien.notelepon?this.item.pasien.notelepon:"-",alamat:null!=this.item.pasien.alamatlengkap?this.item.pasien.alamatlengkap:"-",jkid:null!=this.item.pasien.jeniskelamin?this.item.pasien.jeniskelamin.id:null};this.apiService.post("farmasi/save-resep-nonlayanan",{strukresep:t,details:this.data2}).subscribe(a=>{"-"==this.norec_resep?this.apiService.postLog("Simpan Pelayanan Resep Non Layanan","Norec strukresep_t",a.data.norec,"Simpan Pelayanan Resep Non Layanan Dengan Noresep - "+a.data.nostruk+" atas Nama Pasien - "+a.data.namapasien_klien).subscribe(a=>{}):this.apiService.postLog("Simpan Ubah Pelayanan Resep Non Layanan","Norec strukresep_t",a.data.norec,"Simpan Ubah Pelayanan Resep Non Layanan Dengan Noresep - "+a.data.nostruk+" atas Nama Pasien - "+a.data.namapasien_klien).subscribe(a=>{}),this.kosongkan(),this.clear(),this.data2=[],this.dataSource=void 0,window.history.back()})}else alert("Pilih Produk terlebih dahulu!!");else this.alertService.error("Info","Nama Pasien Masih Kosong!");else this.alertService.error("Info","Data Tanggal Resep Masih Kosong!");else this.alertService.error("Info","Data Penulis Resep Masih Kosong!");else this.alertService.error("Info","Data Ruangan Masih Kosong!")}}return a.\u0275fac=function(e){return new(e||a)(l.Jb(r.a),l.Jb(r.b),l.Jb(s.a),l.Jb(s.h),l.Jb(h.a),l.Jb(d.a),l.Jb(u.a),l.Jb(n.a),l.Jb(n.f))},a.\u0275cmp=l.Db({type:a,selectors:[["app-input-resep-nonlayanan"]],features:[l.wb([s.a])],decls:151,vars:72,consts:[[1,"p-fluid","p-formgrid"],[1,"card","card-w-title"],[1,"p-grid"],[1,"p-col-12","p-md-3"],[1,"p-col-12","p-md-12"],["header","Data Resep",3,"toggleable"],["for","input",1,"label"],["yearRange","1980:2030","dateFormat","yy-mm-dd","placeholder","Tgl Resep","hourFormat","24",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","maxDate","ngModelChange"],["placeholder","Ruangan ","optionLabel","namaruangan","dataKey","id",3,"options","ngModel","filter","showClear","disabled","ngModelChange"],["type","text","pInputText","","placeholder","Nomor Resep","disabled","",3,"ngModel","ngModelChange"],["placeholder","Penulis","optionLabel","namalengkap",3,"options","ngModel","filter","showClear","ngModelChange"],["header","Info Pasien",3,"toggleable"],["type","text","pInputText","","placeholder","Nomor RM",3,"ngModel","ngModelChange","keyup.enter"],["type","text","pInputText","","placeholder","Nama Pasien",3,"ngModel","ngModelChange"],["placeholder","Jenis Kelamin","optionLabel","jeniskelamin","dataKey","id",3,"options","ngModel","filter","showClear","ngModelChange"],["yearRange","1980:2030","dateFormat","yy-mm-dd","placeholder","Tgl Lahir","hourFormat","24",3,"ngModel","showIcon","monthNavigator","yearNavigator","showTime","ngModelChange"],["type","text","pInputText","","placeholder","Telepon",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Alamat",3,"ngModel","ngModelChange"],[1,"p-col-12","p-md-9"],["header","Resep",3,"toggleable"],["label","Obat Kronis","binary","true","inputId","item.SelectedObatKronis",3,"ngModel","ngModelChange","onChange"],[1,"p-col-12","p-md-1"],["type","text","pInputText","","placeholder","R/Ke ",3,"ngModel","ngModelChange"],["class","p-col-12 p-md-6 p-field-checkbox",4,"ngFor","ngForOf"],["class","p-col-12 p-md-2",4,"ngIf"],["type","text","pInputText","","placeholder","Kekuatan",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Stok",3,"ngModel","ngModelChange"],[1,"p-col-12","p-md-4"],["field","namaproduk","placeholder","Pilih Produk",3,"ngModel","suggestions","dropdown","ngModelChange","completeMethod","onSelect"],["placeholder","Qty","inputId","stacked",3,"ngModel","showButtons","ngModelChange","onInput"],[1,"p-col-12","p-md-2"],["placeholder","Satuan ","optionLabel","satuanstandar","dataKey","id",3,"options","ngModel","filter","showClear","ngModelChange","onChange"],["type","text","pInputText","","placeholder","Harga","disabled","",3,"ngModel","ngModelChange"],["placeholder","Disc %","inputId","stacked",3,"ngModel","showButtons","ngModelChange","onInput"],["type","text","pInputText","","placeholder","Total","disabled","",3,"ngModel","ngModelChange"],["type","text","pInputText","","placeholder","Aturan Pakai",3,"ngModel","ngModelChange"],["class","p-col-12 p-md-3 p-field-checkbox",4,"ngFor","ngForOf"],["placeholder","Satuan Resep  ","optionLabel","satuanresep","dataKey","id",3,"options","ngModel","filter","showClear","ngModelChange"],["type","text","pInputText","","placeholder","Keterangan",3,"ngModel","ngModelChange"],[1,"p-col-12","p-md-2","p-md-offset-8"],["pButton","","type","button","icon","pi pi-plus","pTooltip","Tambah","label","Tambah",1,"p-button","p-button-success","p-mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-refresh","pTooltip","Batal","label","Batal",1,"p-button","p-button-warning","p-mr-2",3,"click"],["header","Detail Resep",3,"toggleable"],["styleClass","p-datatable-customers","scrollable","true","dataKey","no",3,"value","columns","rows","showCurrentPageReport","rowsPerPageOptions","paginator","pageLinks"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],[1,"p-col-12","p-md-6"],[1,"p-col-12","p-md-3","p-md-offset-3"],["pButton","","type","button","icon","pi pi-save","pTooltip","Simpan Data","label","Simpan",1,"p-button","p-mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-refresh","pTooltip","Batal","label","Reset",1,"p-button","p-button-danger","p-mr-2",3,"click"],["pButton","","type","button","icon","fa fa-arrow-left","pTooltip","Kembali","label","Kembali",1,"p-button","p-button-danger","p-mr-2",3,"click"],[1,"p-col-12","p-md-6","p-field-checkbox"],["name","group2",3,"inputId","value","ngModel","ngModelChange","onClick"],[3,"for"],["placeholder","Jumlah","inputId","stacked",3,"ngModel","showButtons","ngModelChange","onInput"],["type","text","pInputText","","placeholder","Dosis",3,"ngModel","ngModelChange","input"],["placeholder","Jenis Racikan","optionLabel","jenisracikan","dataKey","id",3,"options","ngModel","filter","showClear","ngModelChange"],[1,"p-col-12","p-md-3","p-field-checkbox"],[1,"p-col-12"],["binary","true",3,"ngModel","inputId","ngModelChange","onChange"],[1,"p-col-12",2,"margin-top","-12px"],[2,"width","80px"],[3,"style",4,"ngFor","ngForOf"],["pButton","","type","button","icon","pi pi-user-edit","pTooltip","Edit Data","label","",1,"p-button-rounded","p-mr-2",3,"click"],["pButton","","type","button","icon","pi pi-trash","pTooltip","Hapus Data","label","",1,"p-button-rounded","p-button-danger","p-mr-2",3,"click"],[4,"ngIf"],["rowspan","6"]],template:function(a,e){1&a&&(l.Qb(0,"div",0),l.Qb(1,"div",1),l.Qb(2,"h4"),l.Jc(3,"Input Resep Non Layanan"),l.Pb(),l.Qb(4,"div",2),l.Qb(5,"div",3),l.Qb(6,"div",2),l.Qb(7,"div",4),l.Qb(8,"div",2),l.Qb(9,"div",4),l.Qb(10,"p-panel",5),l.Qb(11,"div",4),l.Qb(12,"div",2),l.Qb(13,"div",4),l.Qb(14,"label",6),l.Jc(15,"Tgl Resep"),l.Pb(),l.Qb(16,"p-calendar",7),l.Yb("ngModelChange",function(a){return e.item.tglresep=a}),l.Pb(),l.Pb(),l.Qb(17,"div",4),l.Qb(18,"label",6),l.Jc(19,"Ruangan "),l.Pb(),l.Qb(20,"p-dropdown",8),l.Yb("ngModelChange",function(a){return e.item.ruangan=a}),l.Pb(),l.Pb(),l.Qb(21,"div",4),l.Qb(22,"label",6),l.Jc(23,"Nomor Resep"),l.Pb(),l.Qb(24,"input",9),l.Yb("ngModelChange",function(a){return e.item.nomorResep=a}),l.Pb(),l.Pb(),l.Qb(25,"div",4),l.Qb(26,"label",6),l.Jc(27,"Penulis Resep "),l.Pb(),l.Qb(28,"p-dropdown",10),l.Yb("ngModelChange",function(a){return e.item.penulisResep=a}),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(29,"div",4),l.Qb(30,"p-panel",11),l.Qb(31,"div",4),l.Qb(32,"div",2),l.Qb(33,"div",4),l.Qb(34,"label",6),l.Jc(35,"Nomor RM"),l.Pb(),l.Qb(36,"input",12),l.Yb("ngModelChange",function(a){return e.item.pasien.norm=a})("keyup.enter",function(){return e.cariPasien()}),l.Pb(),l.Pb(),l.Qb(37,"div",4),l.Qb(38,"label",6),l.Jc(39,"Nama"),l.Pb(),l.Qb(40,"input",13),l.Yb("ngModelChange",function(a){return e.item.pasien.namapasien=a}),l.Pb(),l.Pb(),l.Qb(41,"div",4),l.Qb(42,"label",6),l.Jc(43,"Jenis Kelamin"),l.Pb(),l.Qb(44,"p-dropdown",14),l.Yb("ngModelChange",function(a){return e.item.pasien.jeniskelamin=a}),l.Pb(),l.Pb(),l.Qb(45,"div",4),l.Qb(46,"label",6),l.Jc(47,"Tgl Lahir"),l.Pb(),l.Qb(48,"p-calendar",15),l.Yb("ngModelChange",function(a){return e.item.pasien.tgllahir=a}),l.Pb(),l.Pb(),l.Qb(49,"div",4),l.Qb(50,"label",6),l.Jc(51,"Nomor Telepon"),l.Pb(),l.Qb(52,"input",16),l.Yb("ngModelChange",function(a){return e.item.pasien.notelepon=a}),l.Pb(),l.Pb(),l.Qb(53,"div",4),l.Qb(54,"label",6),l.Jc(55,"Alamat"),l.Pb(),l.Qb(56,"input",17),l.Yb("ngModelChange",function(a){return e.item.pasien.alamatlengkap=a}),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(57,"div",18),l.Qb(58,"div",2),l.Qb(59,"div",4),l.Qb(60,"div",2),l.Qb(61,"div",4),l.Qb(62,"p-panel",19),l.Qb(63,"div",2),l.Qb(64,"div",3),l.Qb(65,"p-checkbox",20),l.Yb("ngModelChange",function(a){return e.item.SelectedObatKronis=a})("onChange",function(a){return e.ObatKronis(a)}),l.Pb(),l.Pb(),l.Pb(),l.Qb(66,"div",2),l.Qb(67,"div",21),l.Qb(68,"label",6),l.Jc(69,"R/Ke "),l.Pb(),l.Qb(70,"input",22),l.Yb("ngModelChange",function(a){return e.item.rke=a}),l.Pb(),l.Pb(),l.Qb(71,"div",3),l.Qb(72,"label",6),l.Jc(73,"Jenis Kemasan "),l.Pb(),l.Qb(74,"div",2),l.Hc(75,S,4,5,"div",23),l.Pb(),l.Pb(),l.Hc(76,j,4,2,"div",24),l.Hc(77,C,4,1,"div",24),l.Hc(78,w,4,4,"div",24),l.Qb(79,"div",21),l.Qb(80,"label",6),l.Jc(81),l.Pb(),l.Qb(82,"input",25),l.Yb("ngModelChange",function(a){return e.item.kekuatan=a}),l.Pb(),l.Pb(),l.Qb(83,"div",21),l.Qb(84,"label",6),l.Jc(85,"Stok"),l.Pb(),l.Qb(86,"input",26),l.Yb("ngModelChange",function(a){return e.item.stok=a}),l.Pb(),l.Pb(),l.Pb(),l.Qb(87,"div",2),l.Qb(88,"div",27),l.Qb(89,"label",6),l.Jc(90,"Produk "),l.Pb(),l.Qb(91,"p-autoComplete",28),l.Yb("ngModelChange",function(a){return e.item.produk=a})("completeMethod",function(a){return e.filterProduk(a)})("onSelect",function(){return e.getSatuan()}),l.Pb(),l.Pb(),l.Qb(92,"div",21),l.Qb(93,"label",6),l.Jc(94,"Qty Obat "),l.Pb(),l.Qb(95,"p-inputNumber",29),l.Yb("ngModelChange",function(a){return e.item.jumlah=a})("onInput",function(a){return e.onChangeQty(a)}),l.Pb(),l.Pb(),l.Qb(96,"div",30),l.Qb(97,"label",6),l.Jc(98,"Satuan "),l.Pb(),l.Qb(99,"p-dropdown",31),l.Yb("ngModelChange",function(a){return e.item.satuan=a})("onChange",function(){return e.getNilaiKonversi()}),l.Pb(),l.Pb(),l.Qb(100,"div",30),l.Qb(101,"label",6),l.Jc(102,"Harga "),l.Pb(),l.Qb(103,"input",32),l.Yb("ngModelChange",function(a){return e.item.hargaSatuan=a}),l.Pb(),l.Pb(),l.Qb(104,"div",21),l.Qb(105,"label",6),l.Jc(106,"Diskon (%)"),l.Pb(),l.Qb(107,"p-inputNumber",33),l.Yb("ngModelChange",function(a){return e.item.hargaDiskon=a})("onInput",function(a){return e.onChangeDiskon(a)}),l.Pb(),l.Pb(),l.Qb(108,"div",30),l.Qb(109,"label",6),l.Jc(110,"Total "),l.Pb(),l.Qb(111,"input",34),l.Yb("ngModelChange",function(a){return e.item.hargaTotal=a}),l.Pb(),l.Pb(),l.Qb(112,"div",30),l.Qb(113,"label",6),l.Jc(114,"Aturan Pakai "),l.Pb(),l.Qb(115,"input",35),l.Yb("ngModelChange",function(a){return e.item.aturanpakaitxt=a}),l.Pb(),l.Pb(),l.Qb(116,"div",30),l.Qb(117,"label",6),l.Jc(118,"\xa0 "),l.Pb(),l.Qb(119,"div",2),l.Hc(120,R,7,4,"div",36),l.Pb(),l.Pb(),l.Qb(121,"div",3),l.Qb(122,"label",6),l.Jc(123,"Satuan Resep "),l.Pb(),l.Qb(124,"p-dropdown",37),l.Yb("ngModelChange",function(a){return e.item.satuanresep=a}),l.Pb(),l.Pb(),l.Qb(125,"div",3),l.Qb(126,"label",6),l.Jc(127,"Keterangan "),l.Pb(),l.Qb(128,"input",38),l.Yb("ngModelChange",function(a){return e.item.KeteranganPakai=a}),l.Pb(),l.Pb(),l.Pb(),l.Qb(129,"div",2),l.Qb(130,"div",39),l.Qb(131,"button",40),l.Yb("click",function(){return e.tambah()}),l.Pb(),l.Pb(),l.Qb(132,"div",30),l.Qb(133,"button",41),l.Yb("click",function(){return e.batal()}),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Qb(134,"div",4),l.Qb(135,"p-panel",42),l.Qb(136,"p-table",43),l.Hc(137,D,3,1,"ng-template",44),l.Hc(138,I,5,1,"ng-template",45),l.Hc(139,Y,5,1,"ng-template",46),l.Pb(),l.Pb(),l.Pb(),l.Qb(140,"div",4),l.Qb(141,"div",2),l.Lb(142,"div",47),l.Qb(143,"div",47),l.Qb(144,"div",2),l.Qb(145,"div",48),l.Qb(146,"button",49),l.Yb("click",function(){return e.save()}),l.Pb(),l.Pb(),l.Qb(147,"div",3),l.Qb(148,"button",50),l.Yb("click",function(){return e.batalGrid()}),l.Pb(),l.Pb(),l.Qb(149,"div",3),l.Qb(150,"button",51),l.Yb("click",function(){return e.Kembali()}),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb(),l.Pb()),2&a&&(l.xb(10),l.ic("toggleable",!0),l.xb(6),l.ic("ngModel",e.item.tglresep)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0)("maxDate",e.maxDateValue),l.xb(4),l.ic("options",e.listRuangan)("ngModel",e.item.ruangan)("filter",!0)("showClear",!0)("disabled",e.disabledRuangan),l.xb(4),l.ic("ngModel",e.item.nomorResep),l.xb(4),l.ic("options",e.listPenulisResep)("ngModel",e.item.penulisResep)("filter",!0)("showClear",!0),l.xb(2),l.ic("toggleable",!0),l.xb(6),l.ic("ngModel",e.item.pasien.norm),l.xb(4),l.ic("ngModel",e.item.pasien.namapasien),l.xb(4),l.ic("options",e.listJenisKelamin)("ngModel",e.item.pasien.jeniskelamin)("filter",!0)("showClear",!0),l.xb(4),l.ic("ngModel",e.item.pasien.tgllahir)("showIcon",!0)("monthNavigator",!0)("yearNavigator",!0)("showTime",!0),l.xb(4),l.ic("ngModel",e.item.pasien.notelepon),l.xb(4),l.ic("ngModel",e.item.pasien.alamatlengkap),l.xb(6),l.ic("toggleable",!0),l.xb(3),l.ic("ngModel",e.item.SelectedObatKronis),l.xb(5),l.ic("ngModel",e.item.rke),l.xb(5),l.ic("ngForOf",e.listJenisKemasan),l.xb(1),l.ic("ngIf",e.showRacikanDose),l.xb(1),l.ic("ngIf",e.showRacikanDose),l.xb(1),l.ic("ngIf",e.showRacikanDose),l.xb(3),l.Lc("Kekuatan ",e.item.sediaan,""),l.xb(1),l.ic("ngModel",e.item.kekuatan),l.xb(4),l.ic("ngModel",e.item.stok),l.xb(5),l.ic("ngModel",e.item.produk)("suggestions",e.listProduk)("dropdown",!0),l.xb(4),l.ic("ngModel",e.item.jumlah)("showButtons",!0),l.xb(4),l.ic("options",e.listSatuan)("ngModel",e.item.satuan)("filter",!0)("showClear",!0),l.xb(4),l.ic("ngModel",e.item.hargaSatuan),l.xb(4),l.ic("ngModel",e.item.hargaDiskon)("showButtons",!0),l.xb(4),l.ic("ngModel",e.item.hargaTotal),l.xb(4),l.ic("ngModel",e.item.aturanpakaitxt),l.xb(5),l.ic("ngForOf",e.listDataSigna),l.xb(4),l.ic("options",e.listsatuanresep)("ngModel",e.item.satuanresep)("filter",!0)("showClear",!0),l.xb(4),l.ic("ngModel",e.item.KeteranganPakai),l.xb(3),l.ic("disabled",!e.statusTambah),l.xb(4),l.ic("toggleable",!0),l.xb(1),l.ic("value",e.dataSource)("columns",e.columnGrid)("rows",20)("showCurrentPageReport",!0)("rowsPerPageOptions",l.mc(71,F))("paginator",!0)("pageLinks",5),l.xb(10),l.ic("disabled",e.isSimpan))},directives:[m.a,p.a,b.g,b.h,c.a,b.a,g.a,k.a,i.k,i.l,f.a,P.a,v.b,Q.a,M.h,s.k,x.a],styles:[""]}),a})()}];let L=(()=>{class a{}return a.\u0275mod=l.Hb({type:a}),a.\u0275inj=l.Gb({factory:function(e){return new(e||a)},imports:[[n.j.forChild(N)],n.j]}),a})();var H=t("PCNd");let O=(()=>{class a{}return a.\u0275mod=l.Hb({type:a}),a.\u0275inj=l.Gb({factory:function(e){return new(e||a)},imports:[[i.b,L,H.a]]}),a})()}}]);